---
title: "Kanäle und Medien des digitalen Marketings"
author: "Thomas Schmid, Damian Krebs"
date: "12 6 2020"
output: pdf_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load-packages, include=FALSE}
library(plyr)
library(psych)
library(dplyr)
library(tidyverse)
library(magrittr)
library(knitr)
library(stringr)
 options(knitr.kable.NA = '')
```


```{r echo=FALSE, include = FALSE}

colorSingleBar <- "steelblue"
colorMan <-"#0703f0"
colorWoman <- #c74dc2"
colorGenderNot <- #85796f
colorsGender <- c("#0703f0","#c74dc2", "#85796f")  

dat <- read.csv2('./Daten.csv')

q24_Alter <- subset(dat, select=c("Nummer", "X24"))
q24_Alter <- q24_Alter %>% rename(Alter = X24)

levels2 = c("unter 18 Jahre", "18-25", "26-32","33-40","41-55","56-65","über 65 Jahre")
levels = addNA(levels2)

q24_Alter <- q24_Alter %>% mutate(AlterText = case_when(
  Alter == 1 ~ levels[1], 
  Alter == 2 ~ levels[2], 
  Alter == 3 ~ levels[3],
  Alter == 4 ~ levels[4],
  Alter == 5 ~ levels[5],
  Alter == 6 ~ levels[6],
  Alter == 7 ~ levels[7],
  TRUE ~  levels[8]) %>% factor(levels))

q24_Alter <- q24_Alter %>% filter(!is.na(AlterText))
q24_Alter <- q24_Alter %>% filter(!is.na(Alter))


getmode <- function(v) {
  uniqv <- na.omit(unique(v))
  uniqv[which.max(tabulate(match(v, uniqv)))]
}

getRowNumber <- function(CurrentRowNumber, CheckRowNumber, NumberOfCategorie, RowAddition)
{
  returnRow <- CurrentRowNumber
  
  if(CheckRowNumber < NumberOfCategorie)
  {
    numberOfAddition <- NumberOfCategorie - CheckRowNumber
    addition <- RowAddition * numberOfAddition
    
    returnRow <- returnRow + addition
  }
  return(returnRow)
}

getfrequenz <- function(x, NumberOfItems, RowNamesLevels, ColumnNames, itemNumbers, TotalAnzeigen){
  numberofColumns <- ncol(x)
  numberofRows <-  nrow(x)
  items <- c(1:NumberOfItems)
  itemscolums <- c(1: numberofColumns)
  
  resultDataframe <- data.frame(Nr = itemNumbers, Feld = RowNamesLevels)
  
  for(itemNumber in items){
    columnname = ColumnNames[itemNumber]
    if(TotalAnzeigen){
    resultDataframe <- resultDataframe %>% mutate(UQ(rlang::sym(columnname)) := "0.00% (0)")
    }else
    {
      resultDataframe <- resultDataframe %>% mutate(UQ(rlang::sym(columnname)) := "(0)")
    }
  }
  
        if(TotalAnzeigen){
  resultDataframe <- resultDataframe %>% mutate(Summe = "0")
        }
  
  for(numberofCurrentColumn in itemscolums){
    
    numbers <- transform(as.data.frame(table(x[numberofCurrentColumn])), percentage = round(Freq/nrow(x[numberofCurrentColumn] %>% filter( !is.na(x[numberofCurrentColumn])))*100, digits = 2))
    numbers$Var1 <- as.numeric(as.character(numbers$Var1))
    
    summeItems <- 0
    for(val in items)
    {
      if(!is.na(numbers[val,1]))
      {
        columnnumber <- as.numeric(numbers[val,1]) +2
        rownumber <- numberofCurrentColumn
        
        resultDataframe[rownumber,columnnumber] <-  paste(if_else(TotalAnzeigen, 
                                                                   paste(as.character(numbers[val,3]),"% ", sep =""), ""), "(",as.character(numbers[val,2]), ")", sep ="")

        summeItems <- summeItems + as.numeric(numbers[val,2])
      }
      if(TotalAnzeigen){
      resultDataframe[numberofCurrentColumn,NumberOfItems +3] <- summeItems
      }
      }
  }
  
  return(resultDataframe)
}

getfrequenzgeschlecht <- function(x, Rowfactors, ColumnNames, TotalAnzeigen){
  numberofColumns <- ncol(x)
  numberoflevels <- nlevels(Rowfactors)
  itemsoflevels <- c(1:numberoflevels)

  numberofColumnNames = length(ColumnNames)
  itemscolums <- c(1: numberofColumnNames)
  
  
  resultDataframe <- data.frame()
  
  rownumber <- 0
  nummerforItem <- 0
  for(itemNumber in itemsoflevels){
    rownumber <- rownumber + 1
    nummerforItem <- nummerforItem +1
    
    resultDataframe[rownumber,1] <- nummerforItem
    resultDataframe[rownumber,2] <- Rowfactors[itemNumber]
    resultDataframe[rownumber,3] <- c("männlich")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("weiblich")
  }
  
  resultDataframe <- resultDataframe %>% rename(
    Nr = V1,
    Feld = V2,
    Auspraegung = V3)
  
  for(itemNumber in itemscolums){
    columnname = ColumnNames[itemNumber]
    if(TotalAnzeigen){
      resultDataframe <- resultDataframe %>% mutate(UQ(rlang::sym(columnname)) := "0.00% (0)")
    }
    else
    {
      resultDataframe <- resultDataframe %>% mutate(UQ(rlang::sym(columnname)) := "(0)")
    }
  }
  
  if(TotalAnzeigen){
    resultDataframe <- resultDataframe %>% mutate(Summe = "(0)")
  }
  
  correctRow <- 1
  for(numberofCurrentColumn in itemsoflevels){
    
    numbers <- transform(as.data.frame(table(x[,numberofCurrentColumn], x$Geschlecht)), 
                         percentagem = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Geschlecht == 1))*100, digits = 2),
                         percentagew = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Geschlecht == 2))*100, digits = 2))
    
    numbers$Var1 <- as.numeric(as.character(numbers$Var1))
    numbers$Var2 <- as.numeric(as.character(numbers$Var2))
    
    numbersm<- numbers[numbers$Var2 == 1,]
    numbersw<- numbers[numbers$Var2 == 2,]
    
    summeItemsm <- 0
    summeItemsw <- 0
    for(val in itemscolums)
    {
      columnnumber <- as.numeric(numbers[val,1]) +3
      
      if(!is.na(numbersm[val,1]))
      { 
        rownumber <- correctRow
        resultDataframe[rownumber,columnnumber] <-
        paste(if_else(TotalAnzeigen, 
                         paste(as.character(numbersm[val,4]),"% ", sep =""), ""),  "(",as.character(numbersm[val,3]), ")", sep ="")

        summeItemsm <- summeItemsm + as.numeric(numbersm[val,3])
      }
      
      if(!is.na(numbersw[val,1]))
      { 
        rownumber <- correctRow + 1
        resultDataframe[rownumber,columnnumber] <-
        paste(if_else(TotalAnzeigen, 
                      paste(as.character(numbersw[val,5]),"% ", sep =""), ""),  "(",as.character(numbersw[val,3]), ")", sep ="")
        
        summeItemsw <- summeItemsw + as.numeric(numbersw[val,3])
      }
      
      if(TotalAnzeigen){
        resultDataframe[correctRow,numberofColumnNames +4] <- summeItemsm
        resultDataframe[correctRow+1,numberofColumnNames +4] <- summeItemsw
      }
    }
    
    correctRow <- correctRow + 2
    }
    
    return(resultDataframe)
}

getfrequenzAlter <- function(x, Rowfactors, ColumnNames, TotalAnzeigen){
  numberofColumns <- ncol(x)
  numberoflevels <- nlevels(Rowfactors)
  itemsoflevels <- c(1:numberoflevels)
  
  numberofColumnNames = length(ColumnNames)
  itemscolums <- c(1: numberofColumnNames)
  
  
  resultDataframe <- data.frame()
  
  rownumber <- 0
  nummerforItem <- 0
  for(itemNumber in itemsoflevels){
    rownumber <- rownumber + 1
    nummerforItem <- nummerforItem +1
    
    resultDataframe[rownumber,1] <- nummerforItem
    resultDataframe[rownumber,2] <- Rowfactors[itemNumber]
    resultDataframe[rownumber,3] <- c("18-25")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("26-32")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("33-40")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("41-55")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("56-65")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("über 65")
  }
  
  resultDataframe <- resultDataframe %>% rename(
    Nr = V1,
    Feld = V2,
    Auspraegung = V3)
  
  for(itemNumber in itemscolums){
    columnname = ColumnNames[itemNumber]
    
    if(TotalAnzeigen){
      resultDataframe <- resultDataframe %>% mutate(UQ(rlang::sym(columnname)) := "0.00% (0)")
    }
    else{
      resultDataframe <- resultDataframe %>% mutate(UQ(rlang::sym(columnname)) := "(0)")
    }
  }
  if(TotalAnzeigen){
    resultDataframe <- resultDataframe %>% mutate(Summe = "0")
  }
  
  correctRow <- 1
  for(numberofCurrentColumn in itemsoflevels){
    
    numbers <- transform(as.data.frame(table(x[,numberofCurrentColumn], x$Alter)), 
                         percentage18 = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Alter == 2))*100, digits = 2),
                         percentage26 = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Alter == 3))*100, digits = 2),
                         percentage33 = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Alter == 4))*100, digits = 2),
                         percentage41 = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Alter == 5))*100, digits = 2),
                         percentage55 = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Alter == 6))*100, digits = 2),
                         percentage65 = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Alter == 7))*100, digits = 2))
    
    numbers$Var1 <- as.numeric(as.character(numbers$Var1))
    numbers$Var2 <- as.numeric(as.character(numbers$Var2))
    
    numbers18<- numbers[numbers$Var2 == 2,]
    numbers26<- numbers[numbers$Var2 == 3,]
    numbers33<- numbers[numbers$Var2 == 4,]
    numbers41<- numbers[numbers$Var2 == 5,]
    numbers55<- numbers[numbers$Var2 == 6,]
    numbers65<- numbers[numbers$Var2 == 7,]
    
    summeItems18 <- 0
    summeItems26 <- 0
    summeItems33 <- 0
    summeItems41 <- 0
    summeItems55 <- 0
    summeItems65 <- 0
    for(val in itemscolums)
    {
      if(!is.na(numbers[val,1]))
      {
        columnnumber <- as.numeric(numbers[val,1]) +3
        rownumber <- 0
        
        if(!is.na(numbers18[val,1]) & !is.na(numbers18[val,3]))
        { 
          rownumber <- correctRow
          resultDataframe[rownumber,columnnumber] <-paste(if_else(TotalAnzeigen, 
                                                                  paste(as.character(numbers18[val,4]),"% ", sep =""), ""), "(",as.character(numbers18[val,3]), ")", sep ="")
          summeItems18 <- summeItems18 + as.numeric(numbers18[val,3])
        }

        if(!is.na(numbers26[val,1]) & !is.na(numbers26[val,3]))
        {
          rownumber <- correctRow + 1
          resultDataframe[rownumber,columnnumber] <- paste(if_else(TotalAnzeigen, 
                                                                   paste(as.character(numbers26[val,5]),"% ", sep =""), ""), "(",as.character(numbers26[val,3]), ")", sep ="")
          summeItems26 <- summeItems26 + as.numeric(numbers26[val,3])
        }
        
        if(!is.na(numbers33[val,1]) & !is.na(numbers33[val,3]))
        {
          rownumber <- correctRow + 2
          resultDataframe[rownumber,columnnumber] <- paste(if_else(TotalAnzeigen, 
                                                                   paste(as.character(numbers33[val,6]),"% ", sep =""), ""), "(",as.character(numbers33[val,3]), ")", sep ="")
          summeItems33 <- summeItems33 + as.numeric(numbers33[val,3])
        }
        
        if(!is.na(numbers41[val,1]) & !is.na(numbers41[val,3]))
        {
          rownumber <- correctRow + 3
          resultDataframe[rownumber,columnnumber] <- paste(if_else(TotalAnzeigen, 
                                                                   paste(as.character(numbers41[val,7]),"% ", sep =""), ""), "(",as.character(numbers41[val,3]), ")", sep ="")
          summeItems41 <- summeItems41 + as.numeric(numbers41[val,3])
        }
        
        if(!is.na(numbers55[val,1]) & !is.na(numbers55[val,3]))
        {
          rownumber <- correctRow + 4
          resultDataframe[rownumber,columnnumber] <- paste(if_else(TotalAnzeigen, 
                                                                   paste(as.character(numbers55[val,8]),"% ", sep =""), ""), "(",as.character(numbers55[val,3]), ")", sep ="")
          summeItems55 <- summeItems55 + as.numeric(numbers55[val,3])
        }
        
        if(!is.na(numbers65[val,1]) & !is.na(numbers65[val,3]))
        {
          rownumber <- correctRow + 5
          resultDataframe[rownumber,columnnumber] <- paste(if_else(TotalAnzeigen, 
                                                                   paste(as.character(numbers65[val,9]),"% ", sep =""), ""), "(",as.character(numbers65[val,3]), ")", sep ="")
          summeItems65 <- summeItems65 + as.numeric(numbers65[val,3])
        }
        
      }
      if(TotalAnzeigen){
        resultDataframe[correctRow,numberofColumnNames +4] <- summeItems18
        resultDataframe[correctRow+1,numberofColumnNames +4] <- summeItems26
        resultDataframe[correctRow+2,numberofColumnNames +4] <- summeItems33
        resultDataframe[correctRow+3,numberofColumnNames +4] <- summeItems41
        resultDataframe[correctRow+4,numberofColumnNames +4] <- summeItems55
        resultDataframe[correctRow+5,numberofColumnNames +4] <- summeItems65
      }
    }
    
    correctRow <- correctRow + 6
  }
  
  return(resultDataframe)
}

getfrequenzgeschlecht15 <- function(x, Rowfactors, ColumnNames){
  numberofColumns <- ncol(x)
  numberoflevels <- nlevels(Rowfactors)
  itemsoflevels <- c(1:numberoflevels)
  
  numberofColumnNames = length(ColumnNames)
  itemscolums <- c(1: numberofColumnNames)
  
  
  resultDataframe <- data.frame()
  
  rownumber <- 0
  nummerforItem <- 0
  for(itemNumber in itemsoflevels){
    rownumber <- rownumber + 1
    nummerforItem <- nummerforItem +1
    
    resultDataframe[rownumber,1] <- nummerforItem
    resultDataframe[rownumber,2] <- Rowfactors[itemNumber]
    resultDataframe[rownumber,3] <- c("männlich")
    resultDataframe[rownumber,4] <- c("(0)")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("weiblich")
    resultDataframe[rownumber,4] <- c("(0)")
  }
  
  resultDataframe <- resultDataframe %>% rename(
    Nr = V1,
    Feld = V2,
    Auspraegung = V3,
    Antwortanzahl =V4)

  correctRow <- 1
  for(numberofCurrentColumn in itemsoflevels){
    
    numbers <- transform(as.data.frame(table(x[,numberofCurrentColumn], x$Geschlecht)), 
                         percentagem = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Geschlecht == 1))*100, digits = 2),
                         percentagew = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Geschlecht == 2))*100, digits = 2))
    
    numbers$Var1 <- as.numeric(as.character(numbers$Var1))
    numbers$Var2 <- as.numeric(as.character(numbers$Var2))
    
    numbersm<- numbers[numbers$Var2 == 1,]
    numbersw<- numbers[numbers$Var2 == 2,]
    
    summeItemsm <- 0
    summeItemsw <- 0
    for(val in itemscolums)
    {
      columnnumber <- as.numeric(numbers[val,1]) +3
      
      if(!is.na(numbersm[val,1]))
      { 
        rownumber <- correctRow
        resultDataframe[rownumber,columnnumber] <-
          paste("(",as.character(numbersm[val,3]), ")", sep ="")
        
        summeItemsm <- summeItemsm + as.numeric(numbersm[val,3])
      }
      
      if(!is.na(numbersw[val,1]))
      { 
        rownumber <- correctRow + 1
        resultDataframe[rownumber,columnnumber] <-
          paste("(",as.character(numbersw[val,3]), ")", sep ="")
        
        summeItemsw <- summeItemsw + as.numeric(numbersw[val,3])
      }
     
    }
    
    correctRow <- correctRow + 2
  }
  
  return(resultDataframe)
}

getfrequenzAlter15 <- function(x, Rowfactors, ColumnNames){
  numberofColumns <- ncol(x)
  numberoflevels <- nlevels(Rowfactors)
  itemsoflevels <- c(1:numberoflevels)
  
  numberofColumnNames = length(ColumnNames)
  itemscolums <- c(1: numberofColumnNames)
  
  
  resultDataframe <- data.frame()
  
  rownumber <- 0
  nummerforItem <- 0
  for(itemNumber in itemsoflevels){
    rownumber <- rownumber + 1
    nummerforItem <- nummerforItem +1
    
    resultDataframe[rownumber,1] <- nummerforItem
    resultDataframe[rownumber,2] <- Rowfactors[itemNumber]
    resultDataframe[rownumber,3] <- c("18-25")
    resultDataframe[rownumber,4] <- c("(0)")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("26-32")
    resultDataframe[rownumber,4] <- c("(0)")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("33-40")
    resultDataframe[rownumber,4] <- c("(0)")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("41-55")
    resultDataframe[rownumber,4] <- c("(0)")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("56-65")
    resultDataframe[rownumber,4] <- c("(0)")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("über 65")
    resultDataframe[rownumber,4] <- c("(0)")
  }
  
  resultDataframe <- resultDataframe %>% rename(
    Nr = V1,
    Feld = V2,
    Auspraegung = V3, 
    Antwortanzahl = V4)
  
   correctRow <- 1
  for(numberofCurrentColumn in itemsoflevels){
    
    numbers <- transform(as.data.frame(table(x[,numberofCurrentColumn], x$Alter)), 
                         percentage18 = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Alter == 2))*100, digits = 2),
                         percentage26 = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Alter == 3))*100, digits = 2),
                         percentage33 = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Alter == 4))*100, digits = 2),
                         percentage41 = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Alter == 5))*100, digits = 2),
                         percentage55 = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Alter == 6))*100, digits = 2),
                         percentage65 = round(Freq/length(which(!is.na(x[,numberofCurrentColumn]) & x$Alter == 7))*100, digits = 2))
    
    numbers$Var1 <- as.numeric(as.character(numbers$Var1))
    numbers$Var2 <- as.numeric(as.character(numbers$Var2))
    
    numbers18<- numbers[numbers$Var2 == 2,]
    numbers26<- numbers[numbers$Var2 == 3,]
    numbers33<- numbers[numbers$Var2 == 4,]
    numbers41<- numbers[numbers$Var2 == 5,]
    numbers55<- numbers[numbers$Var2 == 6,]
    numbers65<- numbers[numbers$Var2 == 7,]
    
    summeItems18 <- 0
    summeItems26 <- 0
    summeItems33 <- 0
    summeItems41 <- 0
    summeItems55 <- 0
    summeItems65 <- 0
    for(val in itemscolums)
    {
      if(!is.na(numbers[val,1]))
      {
        columnnumber <- as.numeric(numbers[val,1]) +3
        rownumber <- 0
        
        if(!is.na(numbers18[val,1]) & !is.na(numbers18[val,3]))
        { 
          rownumber <- correctRow
          resultDataframe[rownumber,columnnumber] <-paste("(",as.character(numbers18[val,3]), ")", sep ="")
          summeItems18 <- summeItems18 + as.numeric(numbers18[val,3])
        }
        
        if(!is.na(numbers26[val,1]) & !is.na(numbers26[val,3]))
        {
          rownumber <- correctRow + 1
          resultDataframe[rownumber,columnnumber] <- paste("(",as.character(numbers26[val,3]), ")", sep ="")
          summeItems26 <- summeItems26 + as.numeric(numbers26[val,3])
        }
        
        if(!is.na(numbers33[val,1]) & !is.na(numbers33[val,3]))
        {
          rownumber <- correctRow + 2
          resultDataframe[rownumber,columnnumber] <- paste("(",as.character(numbers33[val,3]), ")", sep ="")
          summeItems33 <- summeItems33 + as.numeric(numbers33[val,3])
        }
        
        if(!is.na(numbers41[val,1]) & !is.na(numbers41[val,3]))
        {
          rownumber <- correctRow + 3
          resultDataframe[rownumber,columnnumber] <- paste("(",as.character(numbers41[val,3]), ")", sep ="")
          summeItems41 <- summeItems41 + as.numeric(numbers41[val,3])
        }
        
        if(!is.na(numbers55[val,1]) & !is.na(numbers55[val,3]))
        {
          rownumber <- correctRow + 4
          resultDataframe[rownumber,columnnumber] <- paste("(",as.character(numbers55[val,3]), ")", sep ="")
          summeItems55 <- summeItems55 + as.numeric(numbers55[val,3])
        }
        
        if(!is.na(numbers65[val,1]) & !is.na(numbers65[val,3]))
        {
          rownumber <- correctRow + 5
          resultDataframe[rownumber,columnnumber] <- paste("(",as.character(numbers65[val,3]), ")", sep ="")
          summeItems65 <- summeItems65 + as.numeric(numbers65[val,3])
        }
        
      }
    }
    
    correctRow <- correctRow + 6
  }
  
  return(resultDataframe)
}

getfrequenz1Dimension <- function(x, NumberOfItems, RowNamesLevels, itemNumbers){
  items <- c(1:NumberOfItems)
  
  resultDataframe <- data.frame(Nr = itemNumbers, Feld = RowNamesLevels)
  resultDataframe <- resultDataframe %>% mutate(Antwortanzahl= "0.00% (0)")
  
  numbers <- transform(as.data.frame(table(x[1])), percentage = round(Freq/nrow(x[1] %>% filter( !is.na(x[1])))*100, digits = 2))
  numbers$Var1 <- as.numeric(as.character(numbers$Var1))
  
   summeItems <- 0
   rownumber <- 0
  for(val in items)
  {
    if(!is.na(numbers[val,1]))
    {
      columnnumber <- 3
      rownumber <- as.numeric(numbers[val,1])
      
      resultDataframe[rownumber,columnnumber] <- paste(as.character(numbers[val,3]), "% (",as.character(numbers[val,2]), ")", sep ="")
      
      summeItems <- summeItems + as.numeric(numbers[val,2])
    }
  }
   resultDataframe[rownumber+1,1] <- c("Total")
  
  resultDataframe[rownumber+1,3] <- paste("100", "% (",summeItems, ")", sep ="")
  
  return(resultDataframe)
}

getfrequenz1DimensionGeschlecht <- function(x, Rowfactors){
  numberofColumns <- ncol(x)
  numberoflevels <- nlevels(Rowfactors)
  itemsoflevels <- c(1:numberoflevels)
  
  numberoflevels2 <- numberoflevels
  items <- c(1:numberoflevels2)
  
  
  resultDataframe <- data.frame()
  
  
  rownumber <- 0
  nummerforItem <- 0
  for(itemNumber in itemsoflevels){
    rownumber <- rownumber + 1
    nummerforItem <- nummerforItem +1
    
    resultDataframe[rownumber,1] <- nummerforItem
    resultDataframe[rownumber,2] <- Rowfactors[itemNumber]
    resultDataframe[rownumber,3] <- c("männlich")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("weiblich")
  }
  
  resultDataframe <- resultDataframe %>% rename(
    Nr = V1,
    Feld = V2,
    Auspraegung = V3)
  
  
  resultDataframe <- resultDataframe %>% mutate(Antwortanzahl= "0.00% (0)")
  
  
  numbers <- transform(as.data.frame(table(x)), 
                       percentagem = round(Freq/length(which(!is.na(x[1]) & x$Geschlecht == 1))*100, digits = 2),
                       percentagew = round(Freq/length(which(!is.na(x[1]) & x$Geschlecht == 2))*100, digits = 2))
  
  
  numbers[,1] <- as.numeric(as.character(numbers[,1]))
  numbers[,2] <- as.numeric(as.character(numbers[,2]))
  
  numbersm<- numbers[numbers$Geschlecht == 1,]
  numbersw<- numbers[numbers$Geschlecht == 2,]
  
  summeItemsm <- 0
  summeItemsw <- 0
  correctRow <- 1
  checkRowNumber <- 1
  RowadditionCount <- 2
  for(val in items)
  {
    columnnumber <- 4
    
    if(!is.na(numbersm[val,1]))
    { 
      rownumber <- getRowNumber(correctRow, checkRowNumber, numbersm[val,1], RowadditionCount)
      resultDataframe[rownumber,columnnumber] <-paste(as.character(numbersm[val,4]),"% ", "(",as.character(numbersm[val,3]), ")", sep ="")
      summeItemsm <- summeItemsm + as.numeric(numbersm[val,3])
    }
    
    if(!is.na(numbersw[val,1]))
    {
      rownumber <- getRowNumber(correctRow, checkRowNumber, numbersw[val,1], RowadditionCount) + 1
      resultDataframe[rownumber,columnnumber] <- paste(as.character(numbersw[val,5]),"% ", "(",as.character(numbersw[val,3]), ")", sep ="")
      summeItemsw <- summeItemsw + as.numeric(numbersw[val,3])
    }
    
    correctRow <- correctRow + RowadditionCount
    checkRowNumber <- checkRowNumber + 1
  }
  
  resultDataframe[correctRow,1] <- c("Total")
  resultDataframe[correctRow,3] <- c("männlich")
  resultDataframe[correctRow,4] <- paste("(",summeItemsm, ")", sep ="")
  
  correctRow <- correctRow + 1
  resultDataframe[correctRow,1] <- c("Total")
  resultDataframe[correctRow,3] <- c("weiblich")
  resultDataframe[correctRow,4] <- paste("(",summeItemsw, ")", sep ="")
  
  
  return(resultDataframe)
}

getfrequenz1DimensionAlter <- function(x, Rowfactors){
  numberofColumns <- ncol(x)
  numberoflevels <- nlevels(Rowfactors)
  itemsoflevels <- c(1:numberoflevels)
  
  numberoflevels2 <- numberoflevels
  items <- c(1:numberoflevels2)
  
  
  resultDataframe <- data.frame()
  
  
  rownumber <- 0
  nummerforItem <- 0
  for(itemNumber in itemsoflevels){
    rownumber <- rownumber + 1
    nummerforItem <- nummerforItem +1
    
    resultDataframe[rownumber,1] <- nummerforItem
    resultDataframe[rownumber,2] <- Rowfactors[itemNumber]
    resultDataframe[rownumber,3] <- c("18-25")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("26-32")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("33-40")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("41-55")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("56-65")
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("über 65")
  }
  
  resultDataframe <- resultDataframe %>% rename(
    Nr = V1,
    Feld = V2,
    Auspraegung = V3)
  
  
  resultDataframe <- resultDataframe %>% mutate(Antwortanzahl= "0.00% (0)")
  
  
  numbers <- transform(as.data.frame(table(x)), 
                       percentage18 = round(Freq/length(which(!is.na(x[1]) & x$Alter == 2))*100, digits = 2),
                       percentage26 = round(Freq/length(which(!is.na(x[1]) & x$Alter == 3))*100, digits = 2),
                       percentage33 = round(Freq/length(which(!is.na(x[1]) & x$Alter == 4))*100, digits = 2),
                       percentage41 = round(Freq/length(which(!is.na(x[1]) & x$Alter == 5))*100, digits = 2),
                       percentage55 = round(Freq/length(which(!is.na(x[1]) & x$Alter == 6))*100, digits = 2),
                       percentage65 = round(Freq/length(which(!is.na(x[1]) & x$Alter == 7))*100, digits = 2))
  
  numbers[,1] <- as.numeric(as.character(numbers[,1]))
  numbers[,2] <- as.numeric(as.character(numbers[,2]))
  
  numbers18<- numbers[numbers$Alter == 2,]
  numbers26<- numbers[numbers$Alter == 3,]
  numbers33<- numbers[numbers$Alter == 4,]
  numbers41<- numbers[numbers$Alter == 5,]
  numbers55<- numbers[numbers$Alter == 6,]
  numbers65<- numbers[numbers$Alter == 7,]
  
  summeItems18 <- 0
  summeItems26 <- 0
  summeItems33 <- 0
  summeItems41 <- 0
  summeItems55 <- 0
  summeItems65 <- 0
  correctRow <- 1
  checkRowNumber <- 1
  RowadditionCount <- 6
  for(val in items)
  {
    columnnumber <- 4

    if(!is.na(numbers18[val,1]) & !is.na(numbers18[val,3]))
    { 
      rownumber <- getRowNumber(correctRow, checkRowNumber, numbers18[val,1], RowadditionCount)
      resultDataframe[rownumber,columnnumber] <-paste(as.character(numbers18[val,4]),"% ", "(",as.character(numbers18[val,3]), ")", sep ="")
      summeItems18 <- summeItems18 + as.numeric(numbers18[val,3])
    }
    
    if(!is.na(numbers26[val,1]) & !is.na(numbers26[val,3]))
    {
      rownumber <- getRowNumber(correctRow, checkRowNumber, numbers26[val,1], RowadditionCount) + 1
      resultDataframe[rownumber,columnnumber] <- paste(as.character(numbers26[val,5]),"% ", "(",as.character(numbers26[val,3]), ")", sep ="")
      summeItems26 <- summeItems26 + as.numeric(numbers26[val,3])
    }
    
    if(!is.na(numbers33[val,1]) & !is.na(numbers33[val,3]))
    {
      rownumber <- getRowNumber(correctRow, checkRowNumber, numbers33[val,1], RowadditionCount) + 2
      resultDataframe[rownumber,columnnumber] <- paste(as.character(numbers33[val,6]),"% ", "(",as.character(numbers33[val,3]), ")", sep ="")
      summeItems33 <- summeItems33 + as.numeric(numbers33[val,3])
    }
    
    if(!is.na(numbers41[val,1]) & !is.na(numbers41[val,3]))
    {
      rownumber <- getRowNumber(correctRow, checkRowNumber, numbers41[val,1], RowadditionCount) + 3
      resultDataframe[rownumber,columnnumber] <- paste(as.character(numbers41[val,7]),"% ", "(",as.character(numbers41[val,3]), ")", sep ="")
      summeItems41 <- summeItems41 + as.numeric(numbers41[val,3])
    }
    
    if(!is.na(numbers55[val,1]) & !is.na(numbers55[val,3]))
    {
      rownumber <- getRowNumber(correctRow, checkRowNumber, numbers55[val,1], RowadditionCount) + 4
      resultDataframe[rownumber,columnnumber] <- paste(as.character(numbers55[val,8]),"% ", "(",as.character(numbers55[val,3]), ")", sep ="")
      summeItems55 <- summeItems55 + as.numeric(numbers55[val,3])
    }
    
    if(!is.na(numbers65[val,1]) & !is.na(numbers65[val,3]))
    {
      rownumber <- getRowNumber(correctRow, checkRowNumber, numbers65[val,1], RowadditionCount) + 5
      resultDataframe[rownumber,columnnumber] <- paste(as.character(numbers65[val,9]),"% ", "(",as.character(numbers65[val,3]), ")", sep ="")
      summeItems65 <- summeItems65 + as.numeric(numbers65[val,3])
    }
    
    checkRowNumber <- checkRowNumber +1
    correctRow <- correctRow + RowadditionCount
    
  }
  
  resultDataframe[correctRow,1] <- c("Total")
  resultDataframe[correctRow,3] <- c("18-25")
  resultDataframe[correctRow,4] <- paste("(",summeItems18, ")", sep ="")
  
  correctRow <- correctRow + 1
  resultDataframe[correctRow,1] <- c("Total")
  resultDataframe[correctRow,3] <- c("26-32")
  resultDataframe[correctRow,4] <- paste("(",summeItems26, ")", sep ="")
  
  correctRow <- correctRow + 1
  resultDataframe[correctRow,1] <- c("Total")
  resultDataframe[correctRow,3] <-  c("33-40")
  resultDataframe[correctRow,4] <- paste("(",summeItems33, ")", sep ="")
  
  correctRow <- correctRow + 1
  resultDataframe[correctRow,1] <- c("Total")
  resultDataframe[correctRow,3] <- c("41-55")
  resultDataframe[correctRow,4] <- paste("(",summeItems41, ")", sep ="")
  
  correctRow <- correctRow + 1
  resultDataframe[correctRow,1] <- c("Total")
  resultDataframe[correctRow,3] <- c("56-65")
  resultDataframe[correctRow,4] <- paste("(",summeItems55, ")", sep ="")
  
  correctRow <- correctRow + 1
  resultDataframe[correctRow,1] <- c("Total")
  resultDataframe[correctRow,3] <- c("über 65")
  resultDataframe[correctRow,4] <- paste("(",summeItems65, ")", sep ="")
  
  return(resultDataframe)
}


getLageparameter <- function(x, RowNamesLevels, itemNumbers){
  numberofColumns <-ncol(x)
  itemscolums <- c(1: numberofColumns)
  
  values <- as.vector(rep(0, numberofColumns))
  
  
  resultDataframe <- data.frame(Nr = itemNumbers, Feld = RowNamesLevels, Minimum =values, Maximum=values, Modus=values, Mittelwert=values, Standardabweichung=values, Median=values)
  
  for(numberofCurrentColumn in itemscolums){
    
    resultDataframe[numberofCurrentColumn,3] <- min(x[,numberofCurrentColumn] , na.rm = TRUE)
    resultDataframe[numberofCurrentColumn,4] <- max(x[,numberofCurrentColumn], na.rm = TRUE)
    resultDataframe[numberofCurrentColumn,5] <- getmode(x[,numberofCurrentColumn])
    resultDataframe[numberofCurrentColumn,6] <- round(mean(x[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[numberofCurrentColumn,7] <- round(sd(x[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[numberofCurrentColumn,8] <- round(median(x[,numberofCurrentColumn], na.rm = TRUE),digits=2)
  }
  
  return(resultDataframe)
}

getLageparameterAlter <- function(x, RowNamesLevels){
  numberofColumns <-ncol(x)  -1
  itemscolums <- c(1: numberofColumns)
  numberoflevels = nlevels(RowNamesLevels)
  RowNamesLevels <- levels(RowNamesLevels)
  itemsoflevels <- c(1:numberoflevels)
 

  resultDataframe <- data.frame()
  
  rownumber <- 0
  nummerforItem <- 0
  for(itemNumber in itemsoflevels){
    rownumber <- rownumber + 1
    nummerforItem <- nummerforItem +1
    
    resultDataframe[rownumber,1] <- nummerforItem
    resultDataframe[rownumber,2] <- RowNamesLevels[itemNumber]
    resultDataframe[rownumber,3] <- c("18-25")
    resultDataframe[rownumber,4] <- NA
    resultDataframe[rownumber,5] <- NA
    resultDataframe[rownumber,6] <- NA
    resultDataframe[rownumber,7] <- NA
    resultDataframe[rownumber,8] <- NA
    resultDataframe[rownumber,9] <- NA
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("26-32")
    resultDataframe[rownumber,4] <- NA
    resultDataframe[rownumber,5] <- NA
    resultDataframe[rownumber,6] <- NA
    resultDataframe[rownumber,7] <- NA
    resultDataframe[rownumber,8] <- NA
    resultDataframe[rownumber,9] <- NA
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("33-40")
    resultDataframe[rownumber,4] <- NA
    resultDataframe[rownumber,5] <- NA
    resultDataframe[rownumber,6] <- NA
    resultDataframe[rownumber,7] <- NA
    resultDataframe[rownumber,8] <- NA
    resultDataframe[rownumber,9] <- NA
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("41-55")
    resultDataframe[rownumber,4] <- NA
    resultDataframe[rownumber,5] <- NA
    resultDataframe[rownumber,6] <- NA
    resultDataframe[rownumber,7] <- NA
    resultDataframe[rownumber,8] <- NA
    resultDataframe[rownumber,9] <- NA
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("56-65")
    resultDataframe[rownumber,4] <- NA
    resultDataframe[rownumber,5] <- NA
    resultDataframe[rownumber,6] <- NA
    resultDataframe[rownumber,7] <- NA
    resultDataframe[rownumber,8] <- NA
    resultDataframe[rownumber,9] <- NA
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("über 65")
    resultDataframe[rownumber,4] <- NA
    resultDataframe[rownumber,5] <- NA
    resultDataframe[rownumber,6] <- NA
    resultDataframe[rownumber,7] <- NA
    resultDataframe[rownumber,8] <- NA
    resultDataframe[rownumber,9] <- NA
  }

  resultDataframe <- resultDataframe %>% rename(
    Nr = V1,
    Feld = V2,
    Auspraegung = V3,
    Minimum =V4, 
    Maximum=V5, 
    Modus=V6, 
    Mittelwert=V7, 
    Standardabweichung=V8, 
    Median=V9)
  
  
  x18 <- x %>% filter(Alter == 2) %>% subset(select =-c(Alter))
  x26 <- x %>% filter(Alter == 3) %>% subset(select =-c(Alter))
  x33 <- x %>% filter(Alter == 4) %>% subset(select =-c(Alter))
  x41 <- x %>% filter(Alter == 5) %>% subset(select =-c(Alter))
  x55 <- x %>% filter(Alter == 6) %>% subset(select =-c(Alter))
  x65 <- x %>% filter(Alter == 7) %>% subset(select =-c(Alter))
  
  rowNumber <- 0
  for(numberofCurrentColumn in itemscolums){
    
    rowNumber <- rowNumber + 1
    resultDataframe[rowNumber,4] <- min(x18[,numberofCurrentColumn] , na.rm = TRUE)
    resultDataframe[rowNumber,5] <- max(x18[,numberofCurrentColumn], na.rm = TRUE)
    resultDataframe[rowNumber,6] <- getmode(x18[,numberofCurrentColumn])
    resultDataframe[rowNumber,7] <- round(mean(x18[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,8] <- round(sd(x18[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,9] <- round(median(x18[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    
    rowNumber <- rowNumber + 1
    resultDataframe[rowNumber,4] <- min(x26[,numberofCurrentColumn] , na.rm = TRUE)
    resultDataframe[rowNumber,5] <- max(x26[,numberofCurrentColumn], na.rm = TRUE)
    resultDataframe[rowNumber,6] <- getmode(x26[,numberofCurrentColumn])
    resultDataframe[rowNumber,7] <- round(mean(x26[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,8] <- round(sd(x26[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,9] <- round(median(x26[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    
    rowNumber <- rowNumber + 1
    resultDataframe[rowNumber,4] <- min(x33[,numberofCurrentColumn] , na.rm = TRUE)
    resultDataframe[rowNumber,5] <- max(x33[,numberofCurrentColumn], na.rm = TRUE)
    resultDataframe[rowNumber,6] <- getmode(x33[,numberofCurrentColumn])
    resultDataframe[rowNumber,7] <- round(mean(x33[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,8] <- round(sd(x33[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,9] <- round(median(x33[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    
    rowNumber <- rowNumber + 1
    resultDataframe[rowNumber,4] <- min(x41[,numberofCurrentColumn] , na.rm = TRUE)
    resultDataframe[rowNumber,5] <- max(x41[,numberofCurrentColumn], na.rm = TRUE)
    resultDataframe[rowNumber,6] <- getmode(x41[,numberofCurrentColumn])
    resultDataframe[rowNumber,7] <- round(mean(x41[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,8] <- round(sd(x41[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,9] <- round(median(x41[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    
    rowNumber <- rowNumber + 1
    resultDataframe[rowNumber,4] <- min(x55[,numberofCurrentColumn] , na.rm = TRUE)
    resultDataframe[rowNumber,5] <- max(x55[,numberofCurrentColumn], na.rm = TRUE)
    resultDataframe[rowNumber,6] <- getmode(x55[,numberofCurrentColumn])
    resultDataframe[rowNumber,7] <- round(mean(x55[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,8] <- round(sd(x55[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,9] <- round(median(x55[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    
    rowNumber <- rowNumber + 1
    resultDataframe[rowNumber,4] <- min(x65[,numberofCurrentColumn] , na.rm = TRUE)
    resultDataframe[rowNumber,5] <- max(x65[,numberofCurrentColumn], na.rm = TRUE)
    resultDataframe[rowNumber,6] <- getmode(x65[,numberofCurrentColumn])
    resultDataframe[rowNumber,7] <- round(mean(x65[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,8] <- round(sd(x65[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,9] <- round(median(x65[,numberofCurrentColumn], na.rm = TRUE),digits=2)
  }
  
  return(resultDataframe)
}

getLageparameterGeschlecht <- function(x, RowNamesLevels){
  numberofColumns <-ncol(x)  -1
  itemscolums <- c(1: numberofColumns)
  numberoflevels = nlevels(RowNamesLevels)
  RowNamesLevels <- levels(RowNamesLevels)
  itemsoflevels <- c(1:numberoflevels)
  
  
  resultDataframe <- data.frame()
  
  rownumber <- 0
  nummerforItem <- 0
  for(itemNumber in itemsoflevels){
    rownumber <- rownumber + 1
    nummerforItem <- nummerforItem +1
    
    resultDataframe[rownumber,1] <- nummerforItem
    resultDataframe[rownumber,2] <- RowNamesLevels[itemNumber]
    resultDataframe[rownumber,3] <- c("männlich")
    resultDataframe[rownumber,4] <- NA
    resultDataframe[rownumber,5] <- NA
    resultDataframe[rownumber,6] <- NA
    resultDataframe[rownumber,7] <- NA
    resultDataframe[rownumber,8] <- NA
    resultDataframe[rownumber,9] <- NA
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("weiblich")
    resultDataframe[rownumber,4] <- NA
    resultDataframe[rownumber,5] <- NA
    resultDataframe[rownumber,6] <- NA
    resultDataframe[rownumber,7] <- NA
    resultDataframe[rownumber,8] <- NA
    resultDataframe[rownumber,9] <- NA

   

  }
  
  resultDataframe <- resultDataframe %>% rename(
    Nr = V1,
    Feld = V2,
    Auspraegung = V3,
    Minimum =V4, 
    Maximum=V5, 
    Modus=V6, 
    Mittelwert=V7, 
    Standardabweichung=V8, 
    Median=V9)
  
  
  xm <- x %>% filter(Geschlecht == 1) %>% subset(select =-c(Geschlecht))
  xw <- x %>% filter(Geschlecht == 2) %>% subset(select =-c(Geschlecht))

    rowNumber <- 0
  for(numberofCurrentColumn in itemscolums){
    
    rowNumber <- rowNumber + 1
    resultDataframe[rowNumber,4] <- min(xm[,numberofCurrentColumn] , na.rm = TRUE)
    resultDataframe[rowNumber,5] <- max(xm[,numberofCurrentColumn], na.rm = TRUE)
    resultDataframe[rowNumber,6] <- getmode(xm[,numberofCurrentColumn])
    resultDataframe[rowNumber,7] <- round(mean(xm[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,8] <- round(sd(xm[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,9] <- round(median(xm[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    
    rowNumber <- rowNumber + 1
    resultDataframe[rowNumber,4] <- min(xw[,numberofCurrentColumn] , na.rm = TRUE)
    resultDataframe[rowNumber,5] <- max(xw[,numberofCurrentColumn], na.rm = TRUE)
    resultDataframe[rowNumber,6] <- getmode(xw[,numberofCurrentColumn])
    resultDataframe[rowNumber,7] <- round(mean(xw[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,8] <- round(sd(xw[,numberofCurrentColumn], na.rm = TRUE),digits=2)
    resultDataframe[rowNumber,9] <- round(median(xw[,numberofCurrentColumn], na.rm = TRUE),digits=2)
  }
  
  return(resultDataframe)
}

getLageparameter1Dimensional <- function(x, TitelField){
  numberofColumns <-ncol(x)
  itemscolums <- c(1: numberofColumns)
  
  values <- c(0)
  
  
  resultDataframe <- data.frame(Nr = c(1), Feld = TitelField, Minimum =values, Maximum=values, Modus=values, Mittelwert=values, Standardabweichung=values, Median=values)
     resultDataframe[1,3] <- min(x[,1] , na.rm = TRUE)
    resultDataframe[1,4] <- max(x[,1], na.rm = TRUE)
    resultDataframe[1,5] <- getmode(x[,1])
    resultDataframe[1,6] <- round(mean(x[,1], na.rm = TRUE),digits=2)
    resultDataframe[1,7] <- round(sd(x[,1], na.rm = TRUE),digits=2)
    resultDataframe[1,8] <- round(median(x[,1], na.rm = TRUE),digits=2)

  return(resultDataframe)
}

getLageparameter1DimensionalAlter <- function(x, TitelField){

  x18 <- x %>% filter(Alter == 2) %>% subset(select =-c(Alter))
  x26 <- x %>% filter(Alter == 3) %>% subset(select =-c(Alter))
  x33 <- x %>% filter(Alter == 4) %>% subset(select =-c(Alter))
  x41 <- x %>% filter(Alter == 5) %>% subset(select =-c(Alter))
  x55 <- x %>% filter(Alter == 6) %>% subset(select =-c(Alter))
  x65 <- x %>% filter(Alter == 7) %>% subset(select =-c(Alter))
  
  resultDataframe <- data.frame()
  
  rownumber <- 1
    resultDataframe[rownumber,1] <- 1
    resultDataframe[rownumber,2] <- TitelField
    resultDataframe[rownumber,3] <- c("18-25")
    resultDataframe[rownumber,4] <- min(x18[,1] , na.rm = TRUE)
    resultDataframe[rownumber,5] <- max(x18[,1], na.rm = TRUE)
    resultDataframe[rownumber,6] <- getmode(x18[,1])
    resultDataframe[rownumber,7] <- round(mean(x18[,1], na.rm = TRUE),digits=2)
    resultDataframe[rownumber,8] <- round(sd(x18[,1], na.rm = TRUE),digits=2)
    resultDataframe[rownumber,9] <- round(median(x18[,1], na.rm = TRUE),digits=2)

    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("26-32")
    resultDataframe[rownumber,4] <- min(x26[,1] , na.rm = TRUE)
    resultDataframe[rownumber,5] <- max(x26[,1], na.rm = TRUE)
    resultDataframe[rownumber,6] <- getmode(x26[,1])
    resultDataframe[rownumber,7] <- round(mean(x26[,1], na.rm = TRUE),digits=2)
    resultDataframe[rownumber,8] <- round(sd(x26[,1], na.rm = TRUE),digits=2)
    resultDataframe[rownumber,9] <- round(median(x26[,1], na.rm = TRUE),digits=2)
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("33-40")
    resultDataframe[rownumber,4] <- min(x33[,1] , na.rm = TRUE)
    resultDataframe[rownumber,5] <- max(x33[,1], na.rm = TRUE)
    resultDataframe[rownumber,6] <- getmode(x33[,1])
    resultDataframe[rownumber,7] <- round(mean(x33[,1], na.rm = TRUE),digits=2)
    resultDataframe[rownumber,8] <- round(sd(x33[,1], na.rm = TRUE),digits=2)
    resultDataframe[rownumber,9] <- round(median(x33[,1], na.rm = TRUE),digits=2)
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("41-55")
    resultDataframe[rownumber,4] <- min(x41[,1] , na.rm = TRUE)
    resultDataframe[rownumber,5] <- max(x41[,1], na.rm = TRUE)
    resultDataframe[rownumber,6] <- getmode(x41[,1])
    resultDataframe[rownumber,7] <- round(mean(x41[,1], na.rm = TRUE),digits=2)
    resultDataframe[rownumber,8] <- round(sd(x41[,1], na.rm = TRUE),digits=2)
    resultDataframe[rownumber,9] <- round(median(x41[,1], na.rm = TRUE),digits=2)
    
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("56-65")
    resultDataframe[rownumber,4] <- min(x55[,1] , na.rm = TRUE)
    resultDataframe[rownumber,5] <- max(x55[,1], na.rm = TRUE)
    resultDataframe[rownumber,6] <- getmode(x55[,1])
    resultDataframe[rownumber,7] <- round(mean(x55[,1], na.rm = TRUE),digits=2)
    resultDataframe[rownumber,8] <- round(sd(x55[,1], na.rm = TRUE),digits=2)
    resultDataframe[rownumber,9] <- round(median(x55[,1], na.rm = TRUE),digits=2)
    
    if(nrow(x65) > 0)
      {
    rownumber <- rownumber + 1
    resultDataframe[rownumber,1] <- NA
    resultDataframe[rownumber,2] <- NA
    resultDataframe[rownumber,3] <- c("über 65")
    resultDataframe[rownumber,4] <- min(x65[,1] , na.rm = TRUE)
    resultDataframe[rownumber,5] <- max(x65[,1], na.rm = TRUE)
    resultDataframe[rownumber,6] <- getmode(x65[,1])
    resultDataframe[rownumber,7] <- round(mean(x65[,1], na.rm = TRUE),digits=2)
    resultDataframe[rownumber,8] <- round(sd(x65[,1], na.rm = TRUE),digits=2)
    resultDataframe[rownumber,9] <- round(median(x65[,1], na.rm = TRUE),digits=2)
    }
    
    resultDataframe <- resultDataframe %>% rename(
      Nr = V1,
      Feld = V2,
      Auspraegung = V3,
      Minimum =V4, 
      Maximum=V5, 
      Modus=V6, 
      Mittelwert=V7, 
      Standardabweichung=V8, 
      Median=V9)

  return(resultDataframe)
}


getLageparameter1DimensionalGeschlecht <- function(x, TitelField){
  resultDataframe <- data.frame()
  
  xm <- x %>% filter(Geschlecht == 1) %>% subset(select =-c(Geschlecht))
  xw <- x %>% filter(Geschlecht == 2) %>% subset(select =-c(Geschlecht))
  
  rownumber <- 1
  resultDataframe[rownumber,1] <- 1
  resultDataframe[rownumber,2] <- TitelField
  resultDataframe[rownumber,3] <- c("männlich")
  resultDataframe[rownumber,4] <- min(xm[,1] , na.rm = TRUE)
  resultDataframe[rownumber,5] <- max(xm[,1], na.rm = TRUE)
  resultDataframe[rownumber,6] <- getmode(xm[,1])
  resultDataframe[rownumber,7] <- round(mean(xm[,1], na.rm = TRUE),digits=2)
  resultDataframe[rownumber,8] <- round(sd(xm[,1], na.rm = TRUE),digits=2)
  resultDataframe[rownumber,9] <- round(median(xm[,1], na.rm = TRUE),digits=2)
  
  rownumber <- rownumber + 1
  resultDataframe[rownumber,1] <- NA
  resultDataframe[rownumber,2] <- NA
  resultDataframe[rownumber,3] <- c("weiblich")
  resultDataframe[rownumber,4] <- min(xw[,1] , na.rm = TRUE)
  resultDataframe[rownumber,5] <- max(xw[,1], na.rm = TRUE)
  resultDataframe[rownumber,6] <- getmode(xw[,1])
  resultDataframe[rownumber,7] <- round(mean(xw[,1], na.rm = TRUE),digits=2)
  resultDataframe[rownumber,8] <- round(sd(xw[,1], na.rm = TRUE),digits=2)
  resultDataframe[rownumber,9] <- round(median(xw[,1], na.rm = TRUE),digits=2)

  resultDataframe <- resultDataframe %>% rename(
    Nr = V1,
    Feld = V2,
    Auspraegung = V3,
    Minimum =V4, 
    Maximum=V5, 
    Modus=V6, 
    Mittelwert=V7, 
    Standardabweichung=V8, 
    Median=V9)
  

  return(resultDataframe)
}


JoinTableAlterAndGeschlecht <- function(x){
  newtable <- left_join(x,q23_Geschlecht, by = "Nummer")
newtable <- left_join(newtable, q24_Alter, by = "Nummer")
newtable <- newtable %>% filter(!is.na(Geschlecht))
newtable <- newtable %>% filter(!is.na(Alter))
return(newtable)
}

JoinTableGeschlecht <- function(x){
  geschlectfiltertabe <- q23_Geschlecht %>% subset(select = c(Nummer,Geschlecht))
newtable <- left_join(x,geschlectfiltertabe, by = "Nummer")
newtable <- newtable %>% filter(!is.na(Geschlecht))
newtable <- subset(newtable, select = -c(Nummer))
return(newtable)
}

JoinTableAlter <- function(x){
  alterfiltertabe <- q24_Alter %>% subset(select = c(Nummer,Alter))
  newtable <- left_join(x,alterfiltertabe, by = "Nummer")
  newtable <- newtable %>% filter(!is.na(Alter))
  newtable <- subset(newtable, select = -c(Nummer))
  return(newtable)
}



```

# Geschlecht Teilnehmende

## 23 - Wie alt sind Sie?

```{r geschlecht, echo=FALSE}
q23_Geschlecht <- subset(dat, select=c("Nummer", "X23"))
q23_Geschlecht <- q23_Geschlecht %>% rename(Geschlecht = X23)
levels2 = c("männlich", "weiblich")
levels = addNA(levels2)

q23_Geschlecht <- q23_Geschlecht %>% mutate(GeschlechtText = case_when(
  Geschlecht == 1 ~ levels[1], 
  Geschlecht == 2 ~ levels[2], 
  TRUE ~  levels[3]) %>% factor(levels))

q23_Geschlecht <- q23_Geschlecht %>% filter(!is.na(Geschlecht))

q23_Geschlecht %>% ggplot(aes(x= GeschlechtText, fill = GeschlechtText)) + labs(x = "Geschlecht", fill = "Geschlecht", y="Anzahl")  + geom_bar() + geom_text(aes(label =stat(count)), stat= 'count', position = position_stack(vjust = .5),color="white") + scale_fill_manual(values=colorsGender)

q_lageparameter <- getLageparameter1Dimensional(subset(q23_Geschlecht, select = c(Geschlecht)), "Geschlecht")

knitr::kable(
  q_lageparameter, longtable = TRUE, booktabs = TRUE
)

q_frequenz <- getfrequenz1Dimension(subset(q23_Geschlecht, select = c(Geschlecht)),2, levels2, c(1:2))

knitr::kable(
  q_frequenz, longtable = TRUE, booktabs = TRUE
)

```


# Alter Teilnehmende

## 24 - Sind Sie ...?

```{r alter, echo=FALSE}

levels2 = c("unter 18 Jahre", "18-25", "26-32","33-40","41-55","56-65","über 65 Jahre")

q24_AlterJoined <- left_join(q24_Alter,q23_Geschlecht, by = "Nummer")

q24_Alter %>% ggplot(aes(x= AlterText, fill = AlterText)) + labs(x = "Alter", fill = "Alter", y="Anzahl")  + geom_bar() + geom_text(aes(label =stat(count)), stat= 'count', position = position_stack(vjust = .5))

q_lageparameter <- getLageparameter1Dimensional(subset(q24_Alter, select = c(Alter)), "Alter")

knitr::kable(
  q_lageparameter, longtable = TRUE, booktabs = TRUE
)

q_frequenz <- getfrequenz1Dimension(subset(q24_Alter, select = c(Alter)),7, levels2, c(1:7))

knitr::kable(
  q_frequenz, longtable = TRUE, booktabs = TRUE
)


q24_AlterJoined %>% ggplot(aes(x=AlterText)) + geom_bar(fill=colorSingleBar) + xlab("Prozent") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

```


# Suchmaschinenpräferenzen

## 01 - Welche Suchmaschinen verwenden Sie für die Suche nach Informationen und wie oft?

```{r Suchmaschine, echo=FALSE}

q1_Suchmaschine <-  subset(dat, select=c("Nummer", "X01_1", "X01_2", "X01_3", "X01_4", "X01_5", "X01_6", "X01b"))
q1_Suchmaschine <-  q1_Suchmaschine %>% rename(google = X01_1, bing = X01_2, yahoo = X01_3, search.ch = X01_4 , escosia.org = X01_5, Andere =X01_6, TextAndere = X01b)

levels2 = c("nie", "selten", "monatlich","wöchentlich","nahezu täglich")
levels2Angabe = c("nie(1)", "selten(2)", "monatlich(3)","wöchentlich(4)","nahezu täglich(5)")
levels = addNA(levels2)

q1_SuchmaschineAngepasst <- q1_Suchmaschine %>% subset(select =c(Nummer, google, bing, yahoo, search.ch, escosia.org, Andere)) %>% 
  mutate(
  google = case_when(
    google == 1 ~ levels[1], 
    google == 2 ~ levels[2], 
    google == 3 ~ levels[3],
    google == 4 ~ levels[4],
    google == 5 ~ levels[5],
    TRUE ~  levels[1]) %>% factor(levels),
  bing = case_when(
    bing == 1 ~ levels[1], 
    bing == 2 ~ levels[2], 
    bing == 3 ~ levels[3],
    bing == 4 ~ levels[4],
    bing == 5 ~ levels[5],
    TRUE ~  levels[1]) %>% factor(levels),
  yahoo = case_when(
    yahoo == 1 ~ levels[1], 
    yahoo == 2 ~ levels[2], 
    yahoo == 3 ~ levels[3],
    yahoo == 4 ~ levels[4],
    yahoo == 5 ~ levels[5],
    TRUE ~  levels[1]) %>% factor(levels),
  search.ch = case_when(
    search.ch == 1 ~ levels[1], 
    search.ch == 2 ~ levels[2], 
    search.ch == 3 ~ levels[3],
    search.ch == 4 ~ levels[4],
    search.ch == 5 ~ levels[5],
    TRUE ~  levels[1]) %>% factor(levels),
  escosia.org = case_when(
    escosia.org == 1 ~ levels[1], 
    escosia.org == 2 ~ levels[2], 
    escosia.org == 3 ~ levels[3],
    escosia.org == 4 ~ levels[4],
    escosia.org == 5 ~ levels[5],
    TRUE ~  levels[1]) %>% factor(levels),
  Andere = case_when(
    Andere == 1 ~ levels[1], 
    Andere == 2 ~ levels[2], 
    Andere == 3 ~ levels[3],
    Andere == 4 ~ levels[4],
    Andere == 5 ~ levels[5],
    TRUE ~  levels[1]) %>% factor(levels))

q1_SuchmaschineAngepasst <- q1_SuchmaschineAngepasst %>% gather(google, bing, yahoo, search.ch, escosia.org, Andere, key = Suchmaschine, value = Frequenz)

q1_SuchmaschineAngepasst <- q1_SuchmaschineAngepasst %>% filter(!is.na(Frequenz))

q1_SuchmaschineAngepasst$Suchmaschine <- as.factor(q1_SuchmaschineAngepasst$Suchmaschine)
q1_SuchmaschineAngepasst$Frequenz <- as.factor(q1_SuchmaschineAngepasst$Frequenz)
q1_SuchmaschineAngepasst$Suchmaschine <- factor(q1_SuchmaschineAngepasst$Suchmaschine, levels = c("google", "bing", "yahoo","search.ch","escosia.org", "Andere"))
q1_SuchmaschineAngepasst$Frequenz <- factor(q1_SuchmaschineAngepasst$Frequenz, levels2)


q1_SuchmaschineJoined <- JoinTableAlterAndGeschlecht(q1_SuchmaschineAngepasst)

q1_SuchmaschineAngepasst %>% ggplot(aes(x=Frequenz, fill= Suchmaschine)) + geom_bar(position = "dodge2") + xlab("Frequenz") + ylab("Anzahl") + coord_flip()


q1_SuchmaschineTexte <-  q1_Suchmaschine %>% subset(select = c(TextAndere))
q1_SuchmaschineTexte$TextAndere <- str_trim(q1_SuchmaschineTexte$TextAndere)

q1_SuchmaschineTexte <-  q1_SuchmaschineTexte %>% filter(q1_SuchmaschineTexte$TextAndere != "")
AndereTexte <- data.frame(Andere = q1_SuchmaschineTexte)

knitr::kable(
  AndereTexte, longtable = TRUE, booktabs = TRUE
)

q1_lageparameter <- getLageparameter(subset(q1_Suchmaschine, select = c(google, bing, yahoo, search.ch, escosia.org, Andere)), levels(q1_SuchmaschineJoined$Suchmaschine), c(1:6))

knitr::kable(
  q1_lageparameter, longtable = TRUE, booktabs = TRUE
)

q1_frequenz <- getfrequenz(subset(q1_Suchmaschine, select = c(google, bing, yahoo, search.ch, escosia.org, Andere)),5,levels(q1_SuchmaschineJoined$Suchmaschine), levels2Angabe, c(1:6), TRUE)

knitr::kable(
  q1_frequenz, longtable = TRUE, booktabs = TRUE
)

frequenzfactors <- factor(c("google", "bing", "yahoo", "search.ch", "esosia.org", "Andere"), levels = c("google", "bing", "yahoo", "search.ch", "esosia.org", "Andere"))

q1_SuchmaschineJoined %>% ggplot(aes(x=Frequenz, fill= Suchmaschine)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free")  + coord_flip()

q1_SuchmaschineJoinedAlter <- JoinTableAlter(q1_Suchmaschine %>% subset(select =c(Nummer, google, bing, yahoo, search.ch, escosia.org, Andere)))

q_lageparameterAlter <- getLageparameterAlter(q1_SuchmaschineJoinedAlter, q1_SuchmaschineJoined$Suchmaschine)

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)

q1_frequenzalter<- getfrequenzAlter(q1_SuchmaschineJoinedAlter, frequenzfactors, levels2Angabe, TRUE)

knitr::kable(
  q1_frequenzalter, longtable = TRUE, booktabs = TRUE
)

q1_SuchmaschineJoined %>% ggplot(aes(x=Frequenz, fill= Suchmaschine)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()


q1_SuchmaschineJoinedGeschlecht <- JoinTableGeschlecht(q1_Suchmaschine %>% subset(select =c(Nummer, google, bing, yahoo, search.ch, escosia.org, Andere)))

q_lageparameterGeschlecht <- getLageparameterGeschlecht (q1_SuchmaschineJoinedGeschlecht, q1_SuchmaschineJoined$Suchmaschine)

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)


q1_frequenzgeschlecht <- getfrequenzgeschlecht(q1_SuchmaschineJoinedGeschlecht,frequenzfactors,levels2Angabe, TRUE)

knitr::kable(
  q1_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)

```

# Zweite Seite der Resultatseite

## 02 - In wie vielen Prozent der Fälle schauen Sie sich bei der Suche nach Informationendie zweite Resultatseite an?
```{r ZweiteSeite, echo=FALSE}

q2_bezahlteLinks <- subset(dat, select=c("Nummer", "X2"))
q2_bezahlteLinks <- q2_bezahlteLinks %>% rename(ZweiteSeite = X2)

levels2 = c("0 bis 20%", "21 bis 40%", "41 bis 60%","61 bis 80%","81 bis 100%")
levels = addNA(levels2)

q2_bezahlteLinksAngepasst <- q2_bezahlteLinks  %>% subset(select =c(Nummer, ZweiteSeite)) %>% filter(!is.na(ZweiteSeite)) %>% 
  mutate(
  ZweiteSeite = case_when(
    ZweiteSeite == 1 ~ levels[1], 
    ZweiteSeite == 2 ~ levels[2], 
    ZweiteSeite == 3 ~ levels[3],
    ZweiteSeite == 4 ~ levels[4],
    ZweiteSeite == 5 ~ levels[5],
    TRUE ~  levels[6]) %>% factor(levels))

q2_bezahlteLinksAngepasst <- q2_bezahlteLinksAngepasst %>% filter(!is.na(ZweiteSeite))

q2_bezahlteLinksAngepasst %>% ggplot(aes(x=ZweiteSeite)) + geom_bar(fill=colorSingleBar) + xlab("Prozent") + ylab("Anzahl") + coord_flip()

q2_lageparameter <- getLageparameter1Dimensional(subset(q2_bezahlteLinks, select = c(ZweiteSeite)), "Zweite Seite")

knitr::kable(
  q2_lageparameter, longtable = TRUE, booktabs = TRUE
)

q2_frequenz <- getfrequenz1Dimension(subset(q2_bezahlteLinks, select = c(ZweiteSeite)),5, levels2, c(1:5))

knitr::kable(
  q2_frequenz, longtable = TRUE, booktabs = TRUE
)

q2_bezahlteLinksJoined <- JoinTableAlterAndGeschlecht(q2_bezahlteLinksAngepasst)

q2_bezahlteLinksJoined %>% ggplot(aes(x=ZweiteSeite)) + geom_bar(fill=colorSingleBar) + xlab("Prozent") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()


q2_bezahlteLinksJoinedAlter <- JoinTableAlter(q2_bezahlteLinks)

q_lageparameterAlter <- getLageparameter1DimensionalAlter(q2_bezahlteLinksJoinedAlter, "Zeite Seite")

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)


q_frequenzAlter <- getfrequenz1DimensionAlter(q2_bezahlteLinksJoinedAlter,factor(levels2))


knitr::kable(
  q_frequenzAlter, longtable = TRUE, booktabs = TRUE
)

q2_bezahlteLinksJoined %>% ggplot(aes(x=ZweiteSeite)) + geom_bar(fill=colorSingleBar) + xlab("Prozent") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()


q2_bezahlteLinksJoinedGeschlecht <- JoinTableGeschlecht(q2_bezahlteLinks)

q_lageparameterGeschlecht <- getLageparameter1DimensionalGeschlecht (q2_bezahlteLinksJoinedGeschlecht, "Zeite Seite")

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)

q_frequenzGeschlecht <- getfrequenz1DimensionGeschlecht(q2_bezahlteLinksJoinedGeschlecht,factor(levels2))

knitr::kable(
  q_frequenzGeschlecht, longtable = TRUE, booktabs = TRUE
)

```

# Bezahlte Links

## 03 - In wie vielen Prozent der Fälle verwenden Sie auf der Resultatseite der Suche die bezahlten Links?

```{r BezahlteLinks, echo=FALSE}

q3_bezahlteLinks <- subset(dat, select=c("Nummer", "X3"))
q3_bezahlteLinks <- q3_bezahlteLinks %>% rename(ProzentBezahlteLinks = X3)

levels2 = c("81 bis 100%","61 bis 80%","41 bis 60%","21 bis 40%","0 bis 20%")
levels = addNA(levels2)

q3_bezahlteLinksAngepasst <- q3_bezahlteLinks  %>% subset(select =c(Nummer, ProzentBezahlteLinks)) %>% 
  filter(!is.na(ProzentBezahlteLinks)) %>% 
  mutate(
  ProzentBezahlteLinks = case_when(
    ProzentBezahlteLinks == 1 ~ levels[1], 
    ProzentBezahlteLinks == 2 ~ levels[2], 
    ProzentBezahlteLinks == 3 ~ levels[3],
    ProzentBezahlteLinks == 4 ~ levels[4],
    ProzentBezahlteLinks == 5 ~ levels[5],
    TRUE ~  levels[6]) %>% factor(levels))

q3_bezahlteLinksAngepasst <- q3_bezahlteLinksAngepasst %>% filter(!is.na(ProzentBezahlteLinks))

q3_bezahlteLinksAngepasst %>% ggplot(aes(x=ProzentBezahlteLinks)) + geom_bar(fill=colorSingleBar) + xlab("Prozent") + ylab("Anzahl") + coord_flip()

q3_lageparameter <- getLageparameter1Dimensional(subset(q3_bezahlteLinks, select = c(ProzentBezahlteLinks)), "Bezahlte Links")

knitr::kable(
  q3_lageparameter, longtable = TRUE, booktabs = TRUE
)

q3_frequenz <- getfrequenz1Dimension(subset(q3_bezahlteLinks, select = c(ProzentBezahlteLinks)),5, levels2, c(1:5))

knitr::kable(
  q3_frequenz, longtable = TRUE, booktabs = TRUE
)

q3_bezahlteLinksJoined <- JoinTableAlterAndGeschlecht(q3_bezahlteLinksAngepasst)

q3_bezahlteLinksJoined %>% ggplot(aes(x=ProzentBezahlteLinks)) + geom_bar(fill=colorSingleBar) + xlab("Prozent") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()


q3_bezahlteLinksJoinedAlter <- JoinTableAlter(q3_bezahlteLinks)

q_lageparameterAlter <- getLageparameter1DimensionalAlter(q3_bezahlteLinksJoinedAlter, "Bezahlte Links")

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)

q_frequenzAlter <- getfrequenz1DimensionAlter(q3_bezahlteLinksJoinedAlter,factor(levels2))


knitr::kable(
  q_frequenzAlter, longtable = TRUE, booktabs = TRUE
)

q3_bezahlteLinksJoined %>% ggplot(aes(x=ProzentBezahlteLinks)) + geom_bar(fill=colorSingleBar) + xlab("Prozent") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()


q3_bezahlteLinksJoinedGeschlecht <- JoinTableGeschlecht(q3_bezahlteLinks)

q_lageparameterGeschlecht <- getLageparameter1DimensionalGeschlecht (q3_bezahlteLinksJoinedGeschlecht, "Bezahlte Links")

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE

)

q_frequenzGeschlecht <- getfrequenz1DimensionGeschlecht(q3_bezahlteLinksJoinedGeschlecht,factor(levels2))

knitr::kable(
  q_frequenzGeschlecht, longtable = TRUE, booktabs = TRUE
)


```

# Konsum aufgrund von bezahlten Links

## 04 - In wie vielen Prozent der Fälle haben Sie aufgrund von bezahlten Links Produkte oder Dienstleistungen konsumiert?

```{r KonsumBezahlteLinks, echo=FALSE}


q4_bezahlteLinks <- subset(dat, select=c("Nummer", "X4"))
q4_bezahlteLinks <- q4_bezahlteLinks %>% rename(ProzentKaufBezahlteLinks = X4)

levels2 = c("81 bis 100%","61 bis 80%","41 bis 60%","21 bis 40%","0 bis 20%")
levels = addNA(levels2)

q4_bezahlteLinksAngepasst <- q4_bezahlteLinks  %>% subset(select =c(Nummer, ProzentKaufBezahlteLinks)) %>% 
  filter(!is.na(ProzentKaufBezahlteLinks)) %>% 
  mutate(
  ProzentKaufBezahlteLinks = case_when(
    ProzentKaufBezahlteLinks == 1 ~ levels[1], 
    ProzentKaufBezahlteLinks == 2 ~ levels[2], 
    ProzentKaufBezahlteLinks == 3 ~ levels[3],
    ProzentKaufBezahlteLinks == 4 ~ levels[4],
    ProzentKaufBezahlteLinks == 5 ~ levels[5],
    TRUE ~  levels[6]) %>% factor(levels))

q4_bezahlteLinksAngepasst <- q4_bezahlteLinksAngepasst %>% filter(!is.na(ProzentKaufBezahlteLinks))

q4_bezahlteLinksAngepasst %>% ggplot(aes(x=ProzentKaufBezahlteLinks)) + geom_bar(fill=colorSingleBar) + xlab("Prozent") + ylab("Anzahl") + coord_flip()

q4_lageparameter <- getLageparameter1Dimensional(subset(q4_bezahlteLinks, select = c(ProzentKaufBezahlteLinks)), "Konsum")

knitr::kable(
  q4_lageparameter, longtable = TRUE, booktabs = TRUE
)

q4_frequenz <- getfrequenz1Dimension(subset(q4_bezahlteLinks, select = c(ProzentKaufBezahlteLinks)),5, levels2, c(1:5))

knitr::kable(
  q4_frequenz, longtable = TRUE, booktabs = TRUE
)

q4_bezahlteLinksJoined <- JoinTableAlterAndGeschlecht(q4_bezahlteLinksAngepasst)


q4_bezahlteLinksJoined %>% ggplot(aes(x=ProzentKaufBezahlteLinks)) + geom_bar(fill=colorSingleBar) + xlab("Prozent") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()


q4_bezahlteLinksJoinedAlter <- JoinTableAlter(q4_bezahlteLinks)

q_lageparameterAlter <- getLageparameter1DimensionalAlter(q4_bezahlteLinksJoinedAlter, "Konsum")

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)


q_frequenzAlter <- getfrequenz1DimensionAlter(q4_bezahlteLinksJoinedAlter,factor(levels2))


knitr::kable(
  q_frequenzAlter, longtable = TRUE, booktabs = TRUE
)

q4_bezahlteLinksJoined %>% ggplot(aes(x=ProzentKaufBezahlteLinks)) + geom_bar(fill=colorSingleBar) + xlab("Prozent") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q4_bezahlteLinksJoinedGeschlecht <- JoinTableGeschlecht(q4_bezahlteLinks)

q_lageparameterGeschlecht <- getLageparameter1DimensionalGeschlecht (q2_bezahlteLinksJoinedGeschlecht, "Konsum")

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE

)

q_frequenzGeschlecht <- getfrequenz1DimensionGeschlecht(q4_bezahlteLinksJoinedGeschlecht,factor(levels2))

knitr::kable(
  q_frequenzGeschlecht, longtable = TRUE, booktabs = TRUE
)


```


# Zweck des Kaufes

## 05 - Für welchen Zweck kauften Sie über bezahlte Links etwas ein?

```{r ZweckKauf, echo=FALSE}

q5_bezahlteLinks <- subset(dat, select=c("Nummer","X5"))
q5_bezahlteLinks <- q5_bezahlteLinks %>% rename(ZweckKauf = X5)

q5_bezahlteLinks <- q5_bezahlteLinks %>% filter(!is.na(ZweckKauf))

levels2 = c("privat", "geschäftlich", "beides")
levels = addNA(levels2)

q5_bezahlteLinksAngepasst <- q5_bezahlteLinks  %>% subset(select =c(Nummer, ZweckKauf)) %>% 
  filter(!is.na(ZweckKauf)) %>% 
  mutate(
  ZweckKauf = case_when(
    ZweckKauf == 1 ~ levels[1], 
    ZweckKauf == 2 ~ levels[2], 
    ZweckKauf == 3 ~ levels[3],
    TRUE ~  levels[4]) %>% factor(levels))

q5_bezahlteLinksAngepasst <- q5_bezahlteLinksAngepasst %>% filter(!is.na(ZweckKauf))

q5_bezahlteLinksAngepasst %>% ggplot(aes(x=ZweckKauf)) + geom_bar(fill=colorSingleBar) + xlab("Zweck") + ylab("Anzahl") + coord_flip()

q5_lageparameter <- getLageparameter1Dimensional(subset(q5_bezahlteLinks, select = c(ZweckKauf)), "Zweck")

knitr::kable(
  q5_lageparameter, longtable = TRUE, booktabs = TRUE
)

q5_frequenz <- getfrequenz1Dimension(subset(q5_bezahlteLinks, select = c(ZweckKauf)),3,levels2, c(1:3))

knitr::kable(
  q5_frequenz, longtable = TRUE, booktabs = TRUE
)

q5_bezahlteLinksJoined <- JoinTableAlterAndGeschlecht(q5_bezahlteLinksAngepasst)



q5_bezahlteLinksJoined %>% ggplot(aes(x=ZweckKauf)) + geom_bar(fill=colorSingleBar) + xlab("Zweck") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q5_bezahlteLinksJoinedAlter <- JoinTableAlter(q5_bezahlteLinks)

q_lageparameterAlter <- getLageparameter1DimensionalAlter(q5_bezahlteLinksJoinedAlter, "Zweck")

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)


q_frequenzAlter <- getfrequenz1DimensionAlter(q5_bezahlteLinksJoinedAlter,factor(levels2))


knitr::kable(
  q_frequenzAlter, longtable = TRUE, booktabs = TRUE
)

q5_bezahlteLinksJoined %>% ggplot(aes(x=ZweckKauf)) + geom_bar(fill=colorSingleBar) + xlab("Zweck") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()


q5_bezahlteLinksJoinedGeschlecht <- JoinTableGeschlecht(q5_bezahlteLinks)

q_lageparameterGeschlecht <- getLageparameter1DimensionalGeschlecht (q5_bezahlteLinksJoinedGeschlecht, "Zweck")

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE

)


q_frequenzGeschlecht <- getfrequenz1DimensionGeschlecht(q5_bezahlteLinksJoinedGeschlecht,factor(levels2))

knitr::kable(
  q_frequenzGeschlecht, longtable = TRUE, booktabs = TRUE
)

```


# Verwendung Social Media

## 06 - Welche Social Media Kanäle verwenden Sie und wie oft?

```{r SocialMediaVerwendung, echo=FALSE}

q6_VewendungSozialMedia <- subset(dat, select=c("Nummer", "X06_1", "X06_2", "X06_3", "X06_4", "X06_5", "X06_6", "X06_7", "X06_8", "X06b"))
q6_VewendungSozialMedia <-  q6_VewendungSozialMedia %>% rename(Facebook = X06_1, Instagram = X06_2, YouTube = X06_3, Twitter = X06_4 , LinkedIn = X06_5, Snapchat =X06_6, TikTok =X06_7, Andere =X06_8, AndereText = X06b)

levels2Angabe = c("nie(1)", "selten(2)", "monatlich(3)","wöchentlich(4)","nahezu täglich(5)")
levels2 = c("nie", "selten", "monatlich","wöchentlich","nahezu täglich")
levels = addNA(c("nie", "selten", "monatlich","wöchentlich","nahezu täglich"))
q6_VewendungSozialMediaAngepasst <- q6_VewendungSozialMedia %>% subset(select =
                                                                         
              c(Nummer,Facebook, Instagram, YouTube, Twitter, LinkedIn, Snapchat, TikTok, Andere)) %>% 
  mutate(
    Facebook = case_when(
      Facebook == 1 ~ levels[1], 
      Facebook == 2 ~ levels[2], 
      Facebook == 3 ~ levels[3],
      Facebook == 4 ~ levels[4],
      Facebook == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Instagram = case_when(
      Instagram == 1 ~ levels[1], 
      Instagram == 2 ~ levels[2], 
      Instagram == 3 ~ levels[3],
      Instagram == 4 ~ levels[4],
      Instagram == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    YouTube = case_when(
      YouTube == 1 ~ levels[1], 
      YouTube == 2 ~ levels[2], 
      YouTube == 3 ~ levels[3],
      YouTube == 4 ~ levels[4],
      YouTube == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Twitter = case_when(
      Twitter == 1 ~ levels[1], 
      Twitter == 2 ~ levels[2], 
      Twitter == 3 ~ levels[3],
      Twitter == 4 ~ levels[4],
      Twitter == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    LinkedIn = case_when(
      LinkedIn == 1 ~ levels[1], 
      LinkedIn == 2 ~ levels[2], 
      LinkedIn == 3 ~ levels[3],
      LinkedIn == 4 ~ levels[4],
      LinkedIn == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Snapchat = case_when(
      Snapchat == 1 ~ levels[1], 
      Snapchat == 2 ~ levels[2], 
      Snapchat == 3 ~ levels[3],
      Snapchat == 4 ~ levels[4],
      Snapchat == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    TikTok = case_when(
      TikTok == 1 ~ levels[1], 
      TikTok == 2 ~ levels[2], 
      TikTok == 3 ~ levels[3],
      TikTok == 4 ~ levels[4],
      TikTok == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Andere = case_when(
      Andere == 1 ~ levels[1], 
      Andere == 2 ~ levels[2], 
      Andere == 3 ~ levels[3],
      Andere == 4 ~ levels[4],
      Andere == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels))

q6_VewendungSozialMediaAngepasst <- q6_VewendungSozialMediaAngepasst %>% gather(Facebook, Instagram, YouTube, Twitter, LinkedIn, Snapchat, TikTok, Andere, key = SocialMedia, value = Frequenz)

q6_VewendungSozialMediaAngepasst <- q6_VewendungSozialMediaAngepasst %>% filter(!is.na(Frequenz))

q6_VewendungSozialMediaAngepasst$SocialMedia <- as.factor(q6_VewendungSozialMediaAngepasst$SocialMedia)
q6_VewendungSozialMediaAngepasst$Frequenz <- as.factor(q6_VewendungSozialMediaAngepasst$Frequenz)
q6_VewendungSozialMediaAngepasst$SocialMedia <- factor(q6_VewendungSozialMediaAngepasst$SocialMedia, levels = c("Facebook", "Instagram", "YouTube","Twitter","LinkedIn", "Snapchat", "TikTok", "Andere"))
q6_VewendungSozialMediaAngepasst$Frequenz <- factor(q6_VewendungSozialMediaAngepasst$Frequenz, levels = levels2)

q6_VewendungSozialMediaJoined <- JoinTableAlterAndGeschlecht(q6_VewendungSozialMediaAngepasst)

q6_VewendungSozialMediaAngepasst %>% ggplot(aes(x=Frequenz, fill= SocialMedia)) + geom_bar(position = "dodge2") + xlab("Frequenz") + ylab("Anzahl") + coord_flip()

q6_VewendungSozialMediaText <-  q6_VewendungSozialMedia %>% subset(select = c(AndereText))
q6_VewendungSozialMediaText$AndereText <- str_trim(q6_VewendungSozialMediaText$AndereText)

q6_VewendungSozialMediaText <-  q6_VewendungSozialMediaText %>% filter(q6_VewendungSozialMediaText$AndereText != "")
AndereTexte <- data.frame(Andere = q6_VewendungSozialMediaText)

knitr::kable(
  AndereTexte, longtable = TRUE, booktabs = TRUE
)

q6_lageparameter <- getLageparameter(subset(q6_VewendungSozialMedia, select = c(Facebook, Instagram, YouTube, Twitter, LinkedIn, Snapchat, TikTok, Andere)), levels(q6_VewendungSozialMediaAngepasst$SocialMedia), c(1:8))

knitr::kable(
  q6_lageparameter, longtable = TRUE, booktabs = TRUE
)

q6_frequenz <- getfrequenz(subset(q6_VewendungSozialMedia, select = c(Facebook, Instagram, YouTube, Twitter, LinkedIn, Snapchat, TikTok, Andere)),5,levels(q6_VewendungSozialMediaAngepasst$SocialMedia), levels2Angabe, c(1:8), TRUE)

knitr::kable(
  q6_frequenz, longtable = TRUE, booktabs = TRUE
)


frequenzfactors <- factor(c("Facebook", "Instagram", "YouTube", "Twitter", "LinkedIn", "Snapchat", "TikTok", "Andere"), levels = c("Facebook", "Instagram", "YouTube", "Twitter", "LinkedIn", "Snapchat", "TikTok", "Andere"))

q6_VewendungSozialMediaJoined %>% ggplot(aes(x=Frequenz, fill= SocialMedia)) + geom_bar(position = "dodge2") + xlab("Frequenz") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q6_VewendungSozialMediaAlter <- JoinTableAlter(q6_VewendungSozialMedia %>% subset(select = -c(AndereText)))

q_lageparameterAlter <- getLageparameterAlter(q6_VewendungSozialMediaAlter, frequenzfactors)

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)

q_frequenzalter<- getfrequenzAlter(q6_VewendungSozialMediaAlter, frequenzfactors, levels2Angabe, TRUE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)


q6_VewendungSozialMediaJoined %>% ggplot(aes(x=Frequenz, fill= SocialMedia)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()


q6_VewendungSozialMediaGeschlecht <- JoinTableGeschlecht(q6_VewendungSozialMedia %>% subset(select=-c(AndereText)))

q_lageparameterGeschlecht <- getLageparameterGeschlecht (q6_VewendungSozialMediaGeschlecht, frequenzfactors)

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)


q_frequenzgeschlecht <- getfrequenzgeschlecht(q6_VewendungSozialMediaGeschlecht,frequenzfactors,levels2Angabe, TRUE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)

```


# Suche von Produkten oder Dienstleistungen in Social Media

## 07 - Verwenden Sie auf der Suche nach neuen Produkten oder Dienstleistungen Social Media?

```{r SucheInSocailMedia, echo=FALSE}

q7_SucheProduktSozialMedia <- subset(dat, select=c("Nummer", "X07_1", "X07_2"))
q7_SucheProduktSozialMedia <- q7_SucheProduktSozialMedia %>% rename(privat = X07_1, geschäftlich = X07_2)

levels2Angabe = c("nie(1)", "eher nicht(2)", "vielleicht(3)","ziemlich wahr.(4)","ganz sicher(5)")
levels2 = c("nie", "eher nicht", "vielleicht","ziemlich wahrscheinlich","ganz sicher")
levels2kurz = c("nie", "eher nicht", "vielleicht","ziemlich wahr.","ganz sicher")
levels = addNA(levels2)
q7_SucheProduktSozialMediaAngepasst <- q7_SucheProduktSozialMedia %>% subset(select = c(Nummer, privat, geschäftlich)) %>% 
  mutate(
    privat = case_when(
      privat == 1 ~ levels[1], 
      privat == 2 ~ levels[2], 
      privat == 3 ~ levels[3],
      privat == 4 ~ levels[4],
      privat == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    geschäftlich = case_when(
      geschäftlich == 1 ~ levels[1], 
      geschäftlich == 2 ~ levels[2], 
      geschäftlich == 3 ~ levels[3],
      geschäftlich == 4 ~ levels[4],
      geschäftlich == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels))

q7_SucheProduktSozialMediaAngepasst <- q7_SucheProduktSozialMediaAngepasst %>% gather(privat, geschäftlich, key = Art, value = Frequenz)


q7_SucheProduktSozialMediaAngepasst <- q7_SucheProduktSozialMediaAngepasst %>% filter(!is.na(Frequenz))

q7_SucheProduktSozialMediaAngepasst$Art <- as.factor(q7_SucheProduktSozialMediaAngepasst$Art)
q7_SucheProduktSozialMediaAngepasst$Frequenz <- as.factor(q7_SucheProduktSozialMediaAngepasst$Frequenz)
q7_SucheProduktSozialMediaAngepasst$Art <- factor(q7_SucheProduktSozialMediaAngepasst$Art, levels = c("privat", "geschäftlich"))
q7_SucheProduktSozialMediaAngepasst$Frequenz <- factor(q7_SucheProduktSozialMediaAngepasst$Frequenz, levels = levels2)

q7_SucheProduktSozialMediaJoined <- JoinTableAlterAndGeschlecht(q7_SucheProduktSozialMediaAngepasst)


q7_SucheProduktSozialMediaAngepasst %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + coord_flip()

q7_lageparameter <- getLageparameter(subset(q7_SucheProduktSozialMedia, select = c(privat, geschäftlich)), levels(q7_SucheProduktSozialMediaAngepasst$Art), c(1:2))

knitr::kable(
  q7_lageparameter, longtable = TRUE, booktabs = TRUE
)

q7_frequenz <- getfrequenz(subset(q7_SucheProduktSozialMedia, select = c(privat, geschäftlich)),5,levels(q7_SucheProduktSozialMediaAngepasst$Art),levels2Angabe, c(1:2), TRUE)

knitr::kable(
  q7_frequenz, longtable = TRUE, booktabs = TRUE
)

frequenzfactors <- factor(c("privat", "geschäftlich"), levels = c("privat", "geschäftlich"))

q7_SucheProduktSozialMediaJoined %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()


q7_SucheProduktSozialMediaAlterJoined <- JoinTableAlter(q7_SucheProduktSozialMedia)


q_lageparameterAlter <- getLageparameterAlter(q7_SucheProduktSozialMediaAlterJoined, frequenzfactors)

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)

q_frequenzalter<- getfrequenzAlter(q7_SucheProduktSozialMediaAlterJoined, frequenzfactors, levels2Angabe, TRUE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)


q7_SucheProduktSozialMediaJoined %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()


q7_SucheProduktSozialMediaJoinedGeschlecht <- JoinTableGeschlecht(q7_SucheProduktSozialMedia)

q_lageparameterGeschlecht <- getLageparameterGeschlecht (q7_SucheProduktSozialMediaJoinedGeschlecht, frequenzfactors)

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)


q_frequenzgeschlecht <- getfrequenzgeschlecht(q7_SucheProduktSozialMediaJoinedGeschlecht,frequenzfactors,levels2Angabe, TRUE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)


```


# Kommunikation mit Unternehmen über Social Media

## 08 - Kommunizieren Sie mit Unternehmen über Social Media Kanäle?

```{r KommunikationUnterSocialMeida, echo=FALSE}

q8_KommunikationUnternehmen <- subset(dat, select=c("Nummer", "X08_1", "X08_2"))
q8_KommunikationUnternehmen <- q8_KommunikationUnternehmen %>% rename(privat = X08_1, geschäftlich = X08_2)

levels2Angabe = c("nie(1)", "selten(2)", "gelegentlich(3)","oft(4)","immer(5)")
levels2 = c("nie", "selten", "gelegentlich","oft","immer")
levels = addNA(c("nie", "selten", "gelegentlich","oft","immer"))
q8_KommunikationUnternehmenAngepasst <- q8_KommunikationUnternehmen %>% subset(select = c(Nummer, privat, geschäftlich)) %>% 
  mutate(
    privat = case_when(
      privat == 1 ~ levels[1], 
      privat == 2 ~ levels[2], 
      privat == 3 ~ levels[3],
      privat == 4 ~ levels[4],
      privat == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    geschäftlich = case_when(
      geschäftlich == 1 ~ levels[1], 
      geschäftlich == 2 ~ levels[2], 
      geschäftlich == 3 ~ levels[3],
      geschäftlich == 4 ~ levels[4],
      geschäftlich == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels))

q8_KommunikationUnternehmenAngepasst <- q8_KommunikationUnternehmenAngepasst %>% gather(privat, geschäftlich, key = Art, value = Frequenz)

q8_KommunikationUnternehmenAngepasst <- q8_KommunikationUnternehmenAngepasst %>% filter(!is.na(Frequenz))

q8_KommunikationUnternehmenAngepasst$Art <- as.factor(q8_KommunikationUnternehmenAngepasst$Art)
q8_KommunikationUnternehmenAngepasst$Frequenz <- as.factor(q8_KommunikationUnternehmenAngepasst$Frequenz)
q8_KommunikationUnternehmenAngepasst$Art <- factor(q8_KommunikationUnternehmenAngepasst$Art, levels = c("privat", "geschäftlich"))
q8_KommunikationUnternehmenAngepasst$Frequenz <- factor(q8_KommunikationUnternehmenAngepasst$Frequenz, levels = levels2)




q8_KommunikationUnternehmenJoined <- JoinTableAlterAndGeschlecht(q8_KommunikationUnternehmenAngepasst)


q8_KommunikationUnternehmenAngepasst %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + coord_flip()

q8_lageparameter <- getLageparameter(subset(q8_KommunikationUnternehmen, select = c(privat, geschäftlich)), levels(q8_KommunikationUnternehmenAngepasst$Art), c(1:2))

knitr::kable(
  q8_lageparameter, longtable = TRUE, booktabs = TRUE
)

q8_frequenz <- getfrequenz(subset(q8_KommunikationUnternehmen, select = c(privat, geschäftlich)),5,levels(q8_KommunikationUnternehmenAngepasst$Art), levels2Angabe, c(1:2), TRUE)

knitr::kable(
  q8_frequenz, longtable = TRUE, booktabs = TRUE
)


frequenzfactors <- factor(c("privat", "geschäftlich"), levels = c("privat", "geschäftlich"))

q8_KommunikationUnternehmenJoined %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q8_KommunikationUnternehmenJoinedAlter <- JoinTableAlter(q8_KommunikationUnternehmen)

q_lageparameterAlter <- getLageparameterAlter(q8_KommunikationUnternehmenJoinedAlter, frequenzfactors)

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)


q_frequenzalter<- getfrequenzAlter(q8_KommunikationUnternehmenJoinedAlter, frequenzfactors, levels2Angabe, TRUE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)



q8_KommunikationUnternehmenJoined %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()


q8_KommunikationUnternehmenGeschlecht <- JoinTableGeschlecht(q8_KommunikationUnternehmen)

q_lageparameterGeschlecht <- getLageparameterGeschlecht (q8_KommunikationUnternehmenGeschlecht, frequenzfactors)

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)

q_frequenzgeschlecht <- getfrequenzgeschlecht(q8_KommunikationUnternehmenGeschlecht,frequenzfactors,levels2Angabe, TRUE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)



```

# Häufigkeit der Kommunikation über Social Media

## 09 - Wie häufig kommunizieren Sie mit dem gleichen Unternehmen über einen Social Media Kanal?

```{r KommunikationUnterSocialMeidaHaefigkeit, echo=FALSE}

q9_KommunikationUnternehmenhaufig <- subset(dat, select=c("Nummer", "X09_1", "X09_2"))
q9_KommunikationUnternehmenhaufig <- q9_KommunikationUnternehmenhaufig %>% rename(privat = X09_1, geschäftlich = X09_2)

levels2Angabe = c("nie(1)", "selten(2)", "gelegentlich(3)","oft(4)","immer(5)")
levels2 = c("nie", "selten", "gelegentlich","oft","immer")
levels = addNA(c("nie", "selten", "gelegentlich","oft","immer"))
q9_KommunikationUnternehmenhaufigAngepasst2 <- q9_KommunikationUnternehmenhaufig %>% subset(select = c(Nummer,privat, geschäftlich)) %>% 
  mutate(
    privat = case_when(
      privat == 1 ~ levels[1], 
      privat == 2 ~ levels[2], 
      privat == 3 ~ levels[3],
      privat == 4 ~ levels[4],
      privat == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    geschäftlich = case_when(
      geschäftlich == 1 ~ levels[1], 
      geschäftlich == 2 ~ levels[2], 
      geschäftlich == 3 ~ levels[3],
      geschäftlich == 4 ~ levels[4],
      geschäftlich == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels))

q9_KommunikationUnternehmenhaufigAngepasst <- q9_KommunikationUnternehmenhaufigAngepasst2 %>% gather(privat, geschäftlich, key = Art, value = Frequenz)

q9_KommunikationUnternehmenhaufigAngepasst <- q9_KommunikationUnternehmenhaufigAngepasst %>% filter(!is.na(Frequenz))

q9_KommunikationUnternehmenhaufigAngepasst$Art <- as.factor(q9_KommunikationUnternehmenhaufigAngepasst$Art)
q9_KommunikationUnternehmenhaufigAngepasst$Frequenz <- as.factor(q9_KommunikationUnternehmenhaufigAngepasst$Frequenz)
q9_KommunikationUnternehmenhaufigAngepasst$Art <- factor(q9_KommunikationUnternehmenhaufigAngepasst$Art, levels = c("privat", "geschäftlich"))
q9_KommunikationUnternehmenhaufigAngepasst$Frequenz <- factor(q9_KommunikationUnternehmenhaufigAngepasst$Frequenz, levels = levels2)




q9_KommunikationUnternehmenhaufigJoined <- JoinTableAlterAndGeschlecht(q9_KommunikationUnternehmenhaufigAngepasst)

q9_KommunikationUnternehmenhaufigAngepasst %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + coord_flip()

q9_lageparameter <- getLageparameter(subset(q9_KommunikationUnternehmenhaufig, select = c(privat, geschäftlich)), levels(q9_KommunikationUnternehmenhaufigAngepasst$Art), c(1:2))

knitr::kable(
  q9_lageparameter, longtable = TRUE, booktabs = TRUE
)

q9_frequenz <- getfrequenz(subset(q9_KommunikationUnternehmenhaufig, select = c(privat, geschäftlich)),5,levels(q9_KommunikationUnternehmenhaufigAngepasst$Art), levels2Angabe, c(1:2), TRUE)

knitr::kable(
  q9_frequenz, longtable = TRUE, booktabs = TRUE
)

frequenzfactors <- factor(c("privat", "geschäftlich"), levels = c("privat", "geschäftlich"))

q9_KommunikationUnternehmenhaufigJoinedAlter <- JoinTableAlter(q9_KommunikationUnternehmenhaufig)

q9_KommunikationUnternehmenhaufigJoined %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q_lageparameterAlter <- getLageparameterAlter(q9_KommunikationUnternehmenhaufigJoinedAlter, frequenzfactors)

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)

q_frequenzalter<- getfrequenzAlter(q9_KommunikationUnternehmenhaufigJoinedAlter, frequenzfactors, levels2Angabe, TRUE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)


q9_KommunikationUnternehmenhaufigJoined %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q9_KommunikationUnternehmenhaufigGeschlecht <- JoinTableGeschlecht(q9_KommunikationUnternehmenhaufig)

q_lageparameterGeschlecht <- getLageparameterGeschlecht (q9_KommunikationUnternehmenhaufigGeschlecht, frequenzfactors)

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)

q_frequenzgeschlecht <- getfrequenzgeschlecht(q9_KommunikationUnternehmenhaufigGeschlecht,frequenzfactors,levels2Angabe, TRUE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)


```



# Kauf über Social Media von Unternehmen, mit welchen man kommuniziert

## 10 - Kaufen Sie Ihre Produkte oder Dienstleistungen bei dem Unternehmen ein, mit dem Sie über Social Media kommunizieren?

```{r KommunikationUnterSocialMeidaKauf, echo=FALSE}

q10_Unternehmeneinkauf <- subset(dat, select=c("Nummer", "X10_1", "X10_2"))
q10_Unternehmeneinkauf <- q10_Unternehmeneinkauf %>% rename(privat = X10_1, geschäftlich = X10_2)


levels2Angabe = c("nie(1)", "selten(2)", "gelegentlich(3)","oft(4)","immer(5)")
levels2 = c("nie", "selten", "gelegentlich","oft","immer")
levels = addNA(c("nie", "selten", "gelegentlich","oft","immer"))
q10_UnternehmeneinkaufAngepasst2 <- q10_Unternehmeneinkauf %>% subset(select = c(Nummer, privat, geschäftlich)) %>% 
  mutate(
    privat = case_when(
      privat == 1 ~ levels[1], 
      privat == 2 ~ levels[2], 
      privat == 3 ~ levels[3],
      privat == 4 ~ levels[4],
      privat == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    geschäftlich = case_when(
      geschäftlich == 1 ~ levels[1], 
      geschäftlich == 2 ~ levels[2], 
      geschäftlich == 3 ~ levels[3],
      geschäftlich == 4 ~ levels[4],
      geschäftlich == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels))

q10_UnternehmeneinkaufAngepasst <- q10_UnternehmeneinkaufAngepasst2 %>% gather(privat, geschäftlich, key = Art, value = Frequenz)

q10_UnternehmeneinkaufAngepasst <- q10_UnternehmeneinkaufAngepasst %>% filter(!is.na(Frequenz))

q10_UnternehmeneinkaufAngepasst$Art <- as.factor(q10_UnternehmeneinkaufAngepasst$Art)
q10_UnternehmeneinkaufAngepasst$Frequenz <- as.factor(q10_UnternehmeneinkaufAngepasst$Frequenz)
q10_UnternehmeneinkaufAngepasst$Art <- factor(q10_UnternehmeneinkaufAngepasst$Art, levels = c("privat", "geschäftlich"))
q10_UnternehmeneinkaufAngepasst$Frequenz <- factor(q10_UnternehmeneinkaufAngepasst$Frequenz, levels = levels2)

q10_UnternehmeneinkaufJoined <- JoinTableAlterAndGeschlecht(q10_UnternehmeneinkaufAngepasst)


q10_UnternehmeneinkaufAngepasst %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + coord_flip()

q10_lageparameter <- getLageparameter(subset(q10_Unternehmeneinkauf, select = c(privat, geschäftlich)), levels(q10_UnternehmeneinkaufAngepasst$Art), c(1:2))

knitr::kable(
  q10_lageparameter, longtable = TRUE, booktabs = TRUE
)

q10_frequenz <- getfrequenz(subset(q10_Unternehmeneinkauf, select = c(privat, geschäftlich)),5,levels(q10_UnternehmeneinkaufAngepasst$Art), levels2Angabe, c(1:2), TRUE)

knitr::kable(
  q10_frequenz, longtable = TRUE, booktabs = TRUE
)




frequenzfactors <- factor(c("privat", "geschäftlich"), levels = c("privat", "geschäftlich"))

q10_UnternehmeneinkaufJoinedAlter <- JoinTableAlter(q10_Unternehmeneinkauf)

q10_UnternehmeneinkaufJoined %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q_lageparameterAlter <- getLageparameterAlter(q10_UnternehmeneinkaufJoinedAlter, frequenzfactors)

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)


q_frequenzalter<- getfrequenzAlter(q10_UnternehmeneinkaufJoinedAlter, frequenzfactors, levels2Angabe, TRUE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)


q10_UnternehmeneinkaufJoined %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q10_UnternehmeneinkaufGeschlecht <- JoinTableGeschlecht(q10_Unternehmeneinkauf)

q_lageparameterGeschlecht <- getLageparameterGeschlecht (q10_UnternehmeneinkaufGeschlecht, frequenzfactors)

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)



q_frequenzgeschlecht <- getfrequenzgeschlecht(q10_UnternehmeneinkaufGeschlecht,frequenzfactors,levels2Angabe, TRUE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)


```

### Zusammenhang zwischen der Kommunikationshäufigkeit und dem Kauf (privat)

```{r ZusammenhangKaufKommunikation, echo=FALSE}

combinationprivat <- left_join(subset(q10_UnternehmeneinkaufAngepasst2 %>% filter(!is.na(q10_UnternehmeneinkaufAngepasst2$privat)), select= -c(geschäftlich)), subset(q9_KommunikationUnternehmenhaufigAngepasst2 %>% filter(!is.na(q9_KommunikationUnternehmenhaufigAngepasst2$privat)), select= -c(geschäftlich)), by = "Nummer")
combinationprivat <- combinationprivat %>% rename(Kauf = privat.x, Kommunikation = privat.y)
combinationprivat %>% ggplot(aes(x=Kommunikation, fill= Kauf)) + geom_bar(position = "dodge2") + xlab("Kommunikationshäufigkeit") + ylab("Anzahl") + coord_flip()


```

### Zusammenhang zwischen der Kommunikationshäufigkeit und dem Kauf (geschäftlich)

```{r ZusammenhangKaufKommunikation2, echo=FALSE}

combinationgeschäftlich <- left_join(subset(q10_UnternehmeneinkaufAngepasst2 %>% filter(!is.na(q10_UnternehmeneinkaufAngepasst2$geschäftlich)), select= -c(privat)), subset(q9_KommunikationUnternehmenhaufigAngepasst2 %>% filter(!is.na(q9_KommunikationUnternehmenhaufigAngepasst2$geschäftlich)), select= -c(privat)), by = "Nummer")
combinationgeschäftlich <- combinationgeschäftlich %>% rename(Kauf = geschäftlich.x, Kommunikation = geschäftlich.y)
combinationgeschäftlich %>% ggplot(aes(x=Kommunikation, fill= Kauf)) + geom_bar(position = "dodge2") + xlab("Kommunikationshäufigkeit") + ylab("Anzahl") + coord_flip()

```

# Kauf von Angeboten bei der Konkurrenz

## 11 - Kaufen Sie diese Produkte oder Dienstleistungen auch bei der Konkurrenz ein?

```{r KommunikationUnterSocialMeidaKonkurrenz, echo=FALSE}

q11_UnternehmeneinkaufKonkurrenz <- subset(dat, select=c("Nummer", "X11_1", "X11_2"))
q11_UnternehmeneinkaufKonkurrenz <- q11_UnternehmeneinkaufKonkurrenz %>% rename(privat = X11_1, geschäftlich = X11_2)

levels2Angabe = c("keinesfalls(1)", "eher nicht(2)", "vielleicht(3)","ziemlich wahr.(4)","ganz sicher(5)")
levels2 = c("keinesfalls", "eher nicht", "vielleicht","ziemlich wahrscheinlich","ganz sicher")
levels = addNA(levels2)
q11_UnternehmeneinkaufKonkurrenzAngepasst <- q11_UnternehmeneinkaufKonkurrenz %>% subset(select = c(Nummer,privat, geschäftlich)) %>% 
  mutate(
    privat = case_when(
      privat == 1 ~ levels[1], 
      privat == 2 ~ levels[2], 
      privat == 3 ~ levels[3],
      privat == 4 ~ levels[4],
      privat == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    geschäftlich = case_when(
      geschäftlich == 1 ~ levels[1], 
      geschäftlich == 2 ~ levels[2], 
      geschäftlich == 3 ~ levels[3],
      geschäftlich == 4 ~ levels[4],
      geschäftlich == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels))

q11_UnternehmeneinkaufKonkurrenzAngepasst <- q11_UnternehmeneinkaufKonkurrenzAngepasst %>% gather(privat, geschäftlich, key = Art, value = Frequenz)

q11_UnternehmeneinkaufKonkurrenzAngepasst <- q11_UnternehmeneinkaufKonkurrenzAngepasst %>% filter(!is.na(Frequenz))

q11_UnternehmeneinkaufKonkurrenzAngepasst$Art <- as.factor(q11_UnternehmeneinkaufKonkurrenzAngepasst$Art)
q11_UnternehmeneinkaufKonkurrenzAngepasst$Frequenz <- as.factor(q11_UnternehmeneinkaufKonkurrenzAngepasst$Frequenz)
q11_UnternehmeneinkaufKonkurrenzAngepasst$Art <- factor(q11_UnternehmeneinkaufKonkurrenzAngepasst$Art, levels = c("privat", "geschäftlich"))
q11_UnternehmeneinkaufKonkurrenzAngepasst$Frequenz <- factor(q11_UnternehmeneinkaufKonkurrenzAngepasst$Frequenz, levels = levels2)

q11_UnternehmeneinkaufKonkurrenzJoined <- JoinTableAlterAndGeschlecht(q11_UnternehmeneinkaufKonkurrenzAngepasst)

q11_UnternehmeneinkaufKonkurrenzAngepasst %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + coord_flip()

q11_lageparameter <- getLageparameter(subset(q11_UnternehmeneinkaufKonkurrenz, select = c(privat, geschäftlich)), levels(q11_UnternehmeneinkaufKonkurrenzAngepasst$Art), c(1:2))

knitr::kable(
  q11_lageparameter, longtable = TRUE, booktabs = TRUE
)

q11_frequenz <- getfrequenz(subset(q11_UnternehmeneinkaufKonkurrenz, select = c(privat, geschäftlich)),5,levels(q11_UnternehmeneinkaufKonkurrenzAngepasst$Art), levels2Angabe, c(1:2), TRUE)

knitr::kable(
  q11_frequenz, longtable = TRUE, booktabs = TRUE
)





frequenzfactors <- factor(c("privat", "geschäftlich"), levels = c("privat", "geschäftlich"))

q11_UnternehmeneinkaufKonkurrenzJoined %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q11_UnternehmeneinkaufKonkurrenzAlter <- JoinTableAlter(q11_UnternehmeneinkaufKonkurrenz)

q_lageparameterAlter <- getLageparameterAlter(q11_UnternehmeneinkaufKonkurrenzAlter, frequenzfactors)

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)

q_frequenzalter<- getfrequenzAlter(q11_UnternehmeneinkaufKonkurrenzAlter, frequenzfactors, levels2Angabe, TRUE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)

q11_UnternehmeneinkaufKonkurrenzJoined %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q11_UnternehmeneinkaufKonkurrenzGeschlecht <- JoinTableGeschlecht(q11_UnternehmeneinkaufKonkurrenz)

q_lageparameterGeschlecht <- getLageparameterGeschlecht (q11_UnternehmeneinkaufKonkurrenzGeschlecht, frequenzfactors)

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)


q_frequenzgeschlecht <- getfrequenzgeschlecht(q11_UnternehmeneinkaufKonkurrenzGeschlecht,frequenzfactors,levels2Angabe, TRUE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)


```




# Einfluss von Likes auf den Einkauf

## 12 - Wie häufig wird Ihre Kaufentscheidung durch Likes von Bekannten und Freunden beeinflusst?

```{r EinkaufLiks, echo=FALSE}

q12_likseinkauf <- subset(dat, select=c("Nummer", "X12_1", "X12_2"))
q12_likseinkauf <- q12_likseinkauf %>% rename(privat = X12_1, geschäftlich = X12_2)

levels2Angabe = c("nie(1)", "selten(2)", "gelegentlich(3)","oft(4)","immer(5)")
levels2 = c("nie", "selten", "gelegentlich","oft","immer")
levels = addNA(levels2)
q12_likseinkaufAngepasst <- q12_likseinkauf %>% subset(select = c(Nummer, privat, geschäftlich)) %>% 
  mutate(
    privat = case_when(
      privat == 1 ~ levels[1], 
      privat == 2 ~ levels[2], 
      privat == 3 ~ levels[3],
      privat == 4 ~ levels[4],
      privat == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    geschäftlich = case_when(
      geschäftlich == 1 ~ levels[1], 
      geschäftlich == 2 ~ levels[2], 
      geschäftlich == 3 ~ levels[3],
      geschäftlich == 4 ~ levels[4],
      geschäftlich == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels))

q12_likseinkaufAngepasst <- q12_likseinkaufAngepasst %>% gather(privat, geschäftlich, key = Art, value = Frequenz)

q12_likseinkaufAngepasst <- q12_likseinkaufAngepasst %>% filter(!is.na(Frequenz))

q12_likseinkaufAngepasst$Art <- as.factor(q12_likseinkaufAngepasst$Art)
q12_likseinkaufAngepasst$Frequenz <- as.factor(q12_likseinkaufAngepasst$Frequenz)
q12_likseinkaufAngepasst$Art <- factor(q12_likseinkaufAngepasst$Art, levels = c("privat", "geschäftlich"))
q12_likseinkaufAngepasst$Frequenz <- factor(q12_likseinkaufAngepasst$Frequenz, levels = levels2)

q12_likseinkaufJoined <- JoinTableAlterAndGeschlecht(q12_likseinkaufAngepasst)

q12_likseinkaufAngepasst %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + coord_flip()

q12_lageparameter <- getLageparameter(subset(q12_likseinkauf, select = c(privat, geschäftlich)), levels(q12_likseinkaufAngepasst$Art), c(1:2))

knitr::kable(
  q12_lageparameter, longtable = TRUE, booktabs = TRUE
)

q12_frequenz <- getfrequenz(subset(q12_likseinkauf, select = c(privat, geschäftlich)),5,levels(q12_likseinkaufAngepasst$Art), levels2Angabe, c(1:2), TRUE)

knitr::kable(
  q12_frequenz, longtable = TRUE, booktabs = TRUE
)







frequenzfactors <- factor(c("privat", "geschäftlich"), levels = c("privat", "geschäftlich"))

q12_likseinkaufJoined %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q12_likseinkaufAlter <- JoinTableAlter(q12_likseinkauf)

q_lageparameterAlter <- getLageparameterAlter(q12_likseinkaufAlter, frequenzfactors)

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)

q_frequenzalter<- getfrequenzAlter(q12_likseinkaufAlter, frequenzfactors, levels2Angabe, TRUE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)


q12_likseinkaufJoined %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q12_likseinkaufGeschlecht <- JoinTableGeschlecht(q12_likseinkauf)

q_lageparameterGeschlecht <- getLageparameterGeschlecht (q12_likseinkaufGeschlecht, frequenzfactors)

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)


q_frequenzgeschlecht <- getfrequenzgeschlecht(q12_likseinkaufGeschlecht,frequenzfactors,levels2Angabe, TRUE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)


```



# Verwendete Quellen für die Suche nach Angeboten

## 13 - Auf welche Quellen greifen Sie bei Ihrer Suche nach neuen Produkten oder Dienstleistungen zurück und wie oft? - privat

```{r VerwendungQuellenprivat, echo=FALSE}

q13_SucheProduktprivate <- subset(dat, select=c("Nummer", "X13.1_1", "X13.1_2", "X13.1_3", "X13.1_4", "X13.1_5", "X13.1_6"))
q13_SucheProduktprivate <- q13_SucheProduktprivate %>% rename(Vergleichsdienste = X13.1_1, Blogs = X13.1_2, InfluencerIn = X13.1_3, Freunde = X13.1_4, Arbeitnehmende = X13.1_5, SocialMedia = X13.1_6 )

columnNames1 <- c("Vergleichsdienste", "Blogs", "InfluencerIn", "Freunde", "Arbeitnehmende", "SocialMedia")

levels2Angabe = c("nie(1)", "selten(2)", "gelegentlich(3)","oft(4)","immer(5)")
levels2 = c("nie", "selten", "gelegentlich","oft","immer")
levels = addNA(levels2)
q13_SucheProduktprivateAngepasst <- q13_SucheProduktprivate %>% subset(select =              c(Nummer,Vergleichsdienste, Blogs, InfluencerIn, Freunde, Arbeitnehmende, SocialMedia)) %>% 
  mutate(
    Vergleichsdienste = case_when(
      Vergleichsdienste == 1 ~ levels[1], 
      Vergleichsdienste == 2 ~ levels[2], 
      Vergleichsdienste == 3 ~ levels[3],
      Vergleichsdienste == 4 ~ levels[4],
      Vergleichsdienste == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Blogs = case_when(
      Blogs == 1 ~ levels[1], 
      Blogs == 2 ~ levels[2], 
      Blogs == 3 ~ levels[3],
      Blogs == 4 ~ levels[4],
      Blogs == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    InfluencerIn = case_when(
      InfluencerIn == 1 ~ levels[1], 
      InfluencerIn == 2 ~ levels[2], 
      InfluencerIn == 3 ~ levels[3],
      InfluencerIn == 4 ~ levels[4],
      InfluencerIn == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Freunde = case_when(
      Freunde == 1 ~ levels[1], 
      Freunde == 2 ~ levels[2], 
      Freunde == 3 ~ levels[3],
      Freunde == 4 ~ levels[4],
      Freunde == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Arbeitnehmende = case_when(
      Arbeitnehmende == 1 ~ levels[1], 
      Arbeitnehmende == 2 ~ levels[2], 
      Arbeitnehmende == 3 ~ levels[3],
      Arbeitnehmende == 4 ~ levels[4],
      Arbeitnehmende == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    SocialMedia = case_when(
      SocialMedia == 1 ~ levels[1], 
      SocialMedia == 2 ~ levels[2], 
      SocialMedia == 3 ~ levels[3],
      SocialMedia == 4 ~ levels[4],
      SocialMedia == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels))

q13_SucheProduktprivateAngepasst <- q13_SucheProduktprivateAngepasst %>% gather(Vergleichsdienste, Blogs, InfluencerIn, Freunde, Arbeitnehmende, SocialMedia, key = Quelle, value = Frequenz)

q13_SucheProduktprivateAngepasst <- q13_SucheProduktprivateAngepasst %>% filter(!is.na(Frequenz))

q13_SucheProduktprivateAngepasst$Quelle <- as.factor(q13_SucheProduktprivateAngepasst$Quelle)
q13_SucheProduktprivateAngepasst$Frequenz <- as.factor(q13_SucheProduktprivateAngepasst$Frequenz)
q13_SucheProduktprivateAngepasst$Quelle <- factor(q13_SucheProduktprivateAngepasst$Quelle, levels = columnNames1)
q13_SucheProduktprivateAngepasst$Frequenz <- factor(q13_SucheProduktprivateAngepasst$Frequenz, levels = levels2)

q13_SucheProduktprivateJoined <- JoinTableAlterAndGeschlecht(q13_SucheProduktprivateAngepasst)

q13_SucheProduktprivateAngepasst %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + coord_flip()

q6_lageparameter <- getLageparameter(subset(q13_SucheProduktprivate, select = columnNames1), levels(q13_SucheProduktprivateAngepasst$Quelle), c(1:6))

knitr::kable(
  q6_lageparameter, longtable = TRUE, booktabs = TRUE
)

q6_frequenz <- getfrequenz(subset(q13_SucheProduktprivate, select = columnNames1
),5,levels(q13_SucheProduktprivateAngepasst$Quelle), levels2Angabe, c(1:6), TRUE)

knitr::kable(
  q6_frequenz, longtable = TRUE, booktabs = TRUE
)



frequenzfactors <- factor(columnNames1)

q13_SucheProduktprivateJoined %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q13_SucheProduktprivateAlter <- JoinTableAlter(q13_SucheProduktprivate)

q_lageparameterAlter <- getLageparameterAlter(q13_SucheProduktprivateAlter, frequenzfactors)

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)

q_frequenzalter<- getfrequenzAlter(q13_SucheProduktprivateAlter, frequenzfactors, levels2Angabe, TRUE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)


q13_SucheProduktprivateJoined %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q13_SucheProduktprivateGeschlecht <- JoinTableGeschlecht(q13_SucheProduktprivate)

q_lageparameterGeschlecht <- getLageparameterGeschlecht (q13_SucheProduktprivateGeschlecht, frequenzfactors)

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)


q_frequenzgeschlecht <- getfrequenzgeschlecht(q13_SucheProduktprivateGeschlecht,frequenzfactors,levels2Angabe, TRUE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)


```

## 13 - Auf welche Quellen greifen Sie bei Ihrer Suche nach neuen Produkten oder Dienstleistungen zurück und wie oft?- geschäftlich

```{r VerwendungQuellengeschäftlich, echo=FALSE}

q13_SucheProduktfirm <- subset(dat, select=c("Nummer", "X13.2_1", "X13.2_2", "X13.2_3", "X13.2_4", "X13.2_5", "X13.2_6"))
q13_SucheProduktfirm <- q13_SucheProduktfirm %>% rename(Vergleichsdienste = X13.2_1, Blogs = X13.2_2, InfluencerIn = X13.2_3, Freunde = X13.2_4, Arbeitnehmende = X13.2_5, SocialMedia = X13.2_6 )

columnNames1 <- c("Vergleichsdienste", "Blogs", "InfluencerIn", "Freunde", "Arbeitnehmende", "SocialMedia")

levels2Angabe = c("nie(1)", "selten(2)", "gelegentlich(3)","oft(4)","immer(5)")
levels2 = c("nie", "selten", "gelegentlich","oft","immer")
levels = addNA(levels2)
q13_SucheProduktfirmAngepasst <- q13_SucheProduktfirm %>% subset(select =              c(Nummer,Vergleichsdienste, Blogs, InfluencerIn, Freunde, Arbeitnehmende, SocialMedia)) %>% 
  mutate(
    Vergleichsdienste = case_when(
      Vergleichsdienste == 1 ~ levels[1], 
      Vergleichsdienste == 2 ~ levels[2], 
      Vergleichsdienste == 3 ~ levels[3],
      Vergleichsdienste == 4 ~ levels[4],
      Vergleichsdienste == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Blogs = case_when(
      Blogs == 1 ~ levels[1], 
      Blogs == 2 ~ levels[2], 
      Blogs == 3 ~ levels[3],
      Blogs == 4 ~ levels[4],
      Blogs == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    InfluencerIn = case_when(
      InfluencerIn == 1 ~ levels[1], 
      InfluencerIn == 2 ~ levels[2], 
      InfluencerIn == 3 ~ levels[3],
      InfluencerIn == 4 ~ levels[4],
      InfluencerIn == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Freunde = case_when(
      Freunde == 1 ~ levels[1], 
      Freunde == 2 ~ levels[2], 
      Freunde == 3 ~ levels[3],
      Freunde == 4 ~ levels[4],
      Freunde == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Arbeitnehmende = case_when(
      Arbeitnehmende == 1 ~ levels[1], 
      Arbeitnehmende == 2 ~ levels[2], 
      Arbeitnehmende == 3 ~ levels[3],
      Arbeitnehmende == 4 ~ levels[4],
      Arbeitnehmende == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    SocialMedia = case_when(
      SocialMedia == 1 ~ levels[1], 
      SocialMedia == 2 ~ levels[2], 
      SocialMedia == 3 ~ levels[3],
      SocialMedia == 4 ~ levels[4],
      SocialMedia == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels))

q13_SucheProduktfirmAngepasst <- q13_SucheProduktfirmAngepasst %>% gather(Vergleichsdienste, Blogs, InfluencerIn, Freunde, Arbeitnehmende, SocialMedia, key = Quelle, value = Frequenz)

q13_SucheProduktfirmAngepasst <- q13_SucheProduktfirmAngepasst %>% filter(!is.na(Frequenz))

q13_SucheProduktfirmAngepasst$Quelle <- as.factor(q13_SucheProduktfirmAngepasst$Quelle)
q13_SucheProduktfirmAngepasst$Frequenz <- as.factor(q13_SucheProduktfirmAngepasst$Frequenz)
q13_SucheProduktfirmAngepasst$Quelle <- factor(q13_SucheProduktfirmAngepasst$Quelle, levels = columnNames1)
q13_SucheProduktfirmAngepasst$Frequenz <- factor(q13_SucheProduktfirmAngepasst$Frequenz, levels = levels2)

q13_SucheProduktfirmJoined <- JoinTableAlterAndGeschlecht(q13_SucheProduktfirmAngepasst)

q13_SucheProduktfirmAngepasst %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + coord_flip()

q6_lageparameter <- getLageparameter(subset(q13_SucheProduktfirm, select = columnNames1), levels(q13_SucheProduktfirmAngepasst$Quelle), c(1:6))

knitr::kable(
  q6_lageparameter, longtable = TRUE, booktabs = TRUE
)

q6_frequenz <- getfrequenz(subset(q13_SucheProduktfirm, select = columnNames1
),5,levels(q13_SucheProduktfirmAngepasst$Quelle), levels2Angabe, c(1:6), TRUE)

knitr::kable(
  q6_frequenz, longtable = TRUE, booktabs = TRUE
)



frequenzfactors <- factor(columnNames1, levels = columnNames1)

q13_SucheProduktfirmJoined %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q13_SucheProduktfirmAlter <- JoinTableAlter(q13_SucheProduktfirm)

q_lageparameterAlter <- getLageparameterAlter(q13_SucheProduktfirmAlter, frequenzfactors)

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)


q_frequenzalter<- getfrequenzAlter(q13_SucheProduktfirmAlter, frequenzfactors, levels2Angabe, TRUE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)


q13_SucheProduktfirmJoined %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q13_SucheProduktfirmGeschlecht <- JoinTableGeschlecht(q13_SucheProduktfirm)

q_lageparameterGeschlecht <- getLageparameterGeschlecht (q13_SucheProduktfirmGeschlecht, frequenzfactors)

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)



q_frequenzgeschlecht <- getfrequenzgeschlecht(q13_SucheProduktfirmGeschlecht,frequenzfactors,levels2Angabe, TRUE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)

```


# Vertrauenswürdigkeit der Quellen

## 14 - Wie vertrauenswürdig stufen Sie nachfolgende Quellen ein, wenn Sie neue Produkte oder Dienstleistungen suchen?

```{r VertrauenQuellen, echo=FALSE}

q14_Vertrauen <- subset(dat, select=c("Nummer", "X14_1", "X14_2", "X14_3", "X14_4", "X14_5", "X14_6", "X14_7", "X14_8"))
q14_Vertrauen <-  q14_Vertrauen %>% rename(Vergleichsdienste = X14_1, Blogs = X14_2, InfluencerIn = X14_3, Freunde = X14_4, Arbeitnehmende = X14_5, Webseite = X14_6, SocialMedia = X14_7, Email = X14_8)

columnNames1 <- c("Vergleichsdienste", "Blogs", "InfluencerIn", "Freunde", "Arbeitnehmende", "Webseite", "SocialMedia", "Email")

# levels2 = c("nicht vertrauenswürdig", "wenig vertrauenswürdig", "mittelmässig vertrauenswürdig","ziemlich vertrauenswürdig","sehr vertrauenswürdig")

levels2Angabe = c("nicht.(1)", "wenig(2)", "mittelmässig(3)","ziemlich(4)","sehr(5)")
levels2 = c("nicht.", "wenig", "mittelmässig","ziemlich","sehr")
levels = addNA(levels2)

q14_VertrauenAngepasst <- q14_Vertrauen %>% subset(select =              c(Nummer,Vergleichsdienste, Blogs, InfluencerIn, Freunde, Arbeitnehmende, Webseite, SocialMedia, Email)) %>% 
  mutate(
    Vergleichsdienste = case_when(
      Vergleichsdienste == 1 ~ levels[1], 
      Vergleichsdienste == 2 ~ levels[2], 
      Vergleichsdienste == 3 ~ levels[3],
      Vergleichsdienste == 4 ~ levels[4],
      Vergleichsdienste == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Blogs = case_when(
      Blogs == 1 ~ levels[1], 
      Blogs == 2 ~ levels[2], 
      Blogs == 3 ~ levels[3],
      Blogs == 4 ~ levels[4],
      Blogs == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    InfluencerIn = case_when(
      InfluencerIn == 1 ~ levels[1], 
      InfluencerIn == 2 ~ levels[2], 
      InfluencerIn == 3 ~ levels[3],
      InfluencerIn == 4 ~ levels[4],
      InfluencerIn == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Freunde = case_when(
      Freunde == 1 ~ levels[1], 
      Freunde == 2 ~ levels[2], 
      Freunde == 3 ~ levels[3],
      Freunde == 4 ~ levels[4],
      Freunde == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Arbeitnehmende = case_when(
      Arbeitnehmende == 1 ~ levels[1], 
      Arbeitnehmende == 2 ~ levels[2], 
      Arbeitnehmende == 3 ~ levels[3],
      Arbeitnehmende == 4 ~ levels[4],
      Arbeitnehmende == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
        Webseite = case_when(
      Webseite == 1 ~ levels[1], 
      Webseite == 2 ~ levels[2], 
      Webseite == 3 ~ levels[3],
      Webseite == 4 ~ levels[4],
      Webseite == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
        Email = case_when(
      Email == 1 ~ levels[1], 
      Email == 2 ~ levels[2], 
      Email == 3 ~ levels[3],
      Email == 4 ~ levels[4],
      Email == 5 ~ levels[5],
      TRUE ~  levels[1]) %>% factor(levels),
    SocialMedia = case_when(
      SocialMedia == 1 ~ levels[1], 
      SocialMedia == 2 ~ levels[2], 
      SocialMedia == 3 ~ levels[3],
      SocialMedia == 4 ~ levels[4],
      SocialMedia == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels))

q14_VertrauenAngepasst <- q14_VertrauenAngepasst %>% gather(Vergleichsdienste, Blogs, InfluencerIn, Freunde, Arbeitnehmende, Webseite, SocialMedia, Email, key = Quelle, value = Frequenz)

q14_VertrauenAngepasst <- q14_VertrauenAngepasst %>% filter(!is.na(Frequenz))

q14_VertrauenAngepasst$Quelle <- as.factor(q14_VertrauenAngepasst$Quelle)
q14_VertrauenAngepasst$Frequenz <- as.factor(q14_VertrauenAngepasst$Frequenz)
q14_VertrauenAngepasst$Quelle <- factor(q14_VertrauenAngepasst$Quelle, levels = columnNames1)
q14_VertrauenAngepasst$Frequenz <- factor(q14_VertrauenAngepasst$Frequenz, levels = levels2)


q14_VertrauenJoined <- JoinTableAlterAndGeschlecht(q14_VertrauenAngepasst)

q14_VertrauenAngepasst %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("Vertauenswürdigkeit") + ylab("Anzahl") + coord_flip()

q_lageparameter <- getLageparameter(subset(q14_Vertrauen, select = columnNames1), levels(q14_VertrauenAngepasst$Quelle), c(1:8))

knitr::kable(
  q_lageparameter, longtable = TRUE, booktabs = TRUE
)

q_frequenz <- getfrequenz(subset(q14_Vertrauen, select = columnNames1
),5,levels(q14_VertrauenAngepasst$Quelle), levels2Angabe, c(1:8), TRUE)

knitr::kable(
  q_frequenz, longtable = TRUE, booktabs = TRUE
)






frequenzfactors <- factor(columnNames1, levels = columnNames1)

q14_VertrauenJoined %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("Vertauenswürdigkeit") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q14_VertrauenAlter <- JoinTableAlter(q14_Vertrauen)

q_lageparameterAlter <- getLageparameterAlter(q14_VertrauenAlter, frequenzfactors)

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)


q_frequenzalter<- getfrequenzAlter(q14_VertrauenAlter, frequenzfactors, levels2Angabe, TRUE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)


q14_VertrauenJoined %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("Vertauenswürdigkeit") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q14_VertrauenGeschlecht <- JoinTableGeschlecht(q14_Vertrauen)

q_lageparameterGeschlecht <- getLageparameterGeschlecht (q14_VertrauenGeschlecht, frequenzfactors)

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)


q_frequenzgeschlecht <- getfrequenzgeschlecht(q14_VertrauenGeschlecht,frequenzfactors,levels2Angabe, TRUE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)

```


# Gründe für Email-Newsletter Anmeldung

## 15 - Aus welchen Gründen melden Sie sich für einen Email-Newsletter an?

```{r EmailNewsletter, echo=FALSE}

q15_EmailNewsletterprivat <- subset(dat, select=c("Nummer", "X15_1_1", "X15_2_1","X15_3_1", "X15_4_1", "X15_5_1", "X15_6_1"))
q15_EmailNewsletterprivat <- q15_EmailNewsletterprivat  %>% rename(Intresse = X15_1_1, Aktionen = X15_2_1,
                                                                   Angebot = X15_3_1, Inhalt = X15_4_1, Trends = X15_5_1, Unternehmen = X15_6_1)

q15_EmailNewsletterfirm <- subset(dat, select=c("Nummer", "X15_1_2", "X15_2_2","X15_3_2", "X15_4_2", "X15_5_2", "X15_6_2"))
q15_EmailNewsletterfirm <- q15_EmailNewsletterfirm  %>% rename(Intresse = X15_1_2, Aktionen = X15_2_2,
                                                               Angebot = X15_3_2, Inhalt = X15_4_2, Trends = X15_5_2, Unternehmen = X15_6_2)

columnNames1 <- c("Intresse", "Aktionen", "Angebot", "Inhalt", "Trends", "Unternehmen")
levels2 = c("Interesse an einem Produkt / einer Dienstleistung", "Information über Aktionen", "Infromationen über neue Angebote","Inhalt der Informationen","Informationen über neue Trends", "Informationen über das unternehmen")
levels = addNA(levels2)
q15_EmailNewsletterprivatAngepasst <- q15_EmailNewsletterprivat %>% subset(select = columnNames1) %>% 
  mutate(
    Intresse = case_when(
      Intresse == 1 ~ levels[1], 
      Intresse == 2 ~ levels[2], 
      Intresse == 3 ~ levels[3],
      Intresse == 4 ~ levels[4],
      Intresse == 5 ~ levels[5],
      Intresse == 6 ~ levels[6],
      TRUE ~  levels[7]) %>% factor(levels),
    Angebot = case_when(
      Angebot == 1 ~ levels[1], 
      Angebot == 2 ~ levels[2], 
      Angebot == 3 ~ levels[3],
      Angebot == 4 ~ levels[4],
      Angebot == 5 ~ levels[5],
      Angebot == 6 ~ levels[6],
      TRUE ~  levels[7]) %>% factor(levels),
    Inhalt = case_when(
      Inhalt == 1 ~ levels[1], 
      Inhalt == 2 ~ levels[2], 
      Inhalt == 3 ~ levels[3],
      Inhalt == 4 ~ levels[4],
      Inhalt == 5 ~ levels[5],
      Inhalt == 6 ~ levels[6],
      TRUE ~  levels[7]) %>% factor(levels),
    Trends = case_when(
      Trends == 1 ~ levels[1], 
      Trends == 2 ~ levels[2], 
      Trends == 3 ~ levels[3],
      Trends == 4 ~ levels[4],
      Trends == 5 ~ levels[5],
      Trends == 6 ~ levels[6],
      TRUE ~  levels[7]) %>% factor(levels),
    Unternehmen = case_when(
      Unternehmen == 1 ~ levels[1], 
      Unternehmen == 2 ~ levels[2], 
      Unternehmen == 3 ~ levels[3],
      Unternehmen == 4 ~ levels[4],
      Unternehmen == 5 ~ levels[5],
      Unternehmen == 6 ~ levels[6],
      TRUE ~  levels[7]) %>% factor(levels),
    Aktionen = case_when(
      Aktionen == 1 ~ levels[1], 
      Aktionen == 2 ~ levels[2], 
      Aktionen == 3 ~ levels[3],
      Aktionen == 4 ~ levels[4],
      Aktionen == 5 ~ levels[5],
      Aktionen == 6 ~ levels[6],
      TRUE ~  levels[7]) %>% factor(levels))

q15_EmailNewsletterfirmAngepasst <- q15_EmailNewsletterfirm %>% subset(select = c(Nummer, Intresse, Aktionen, Angebot, Inhalt, Trends, Unternehmen)) %>% 
  mutate(
    Intresse = case_when(
      Intresse == 1 ~ levels[1], 
      Intresse == 2 ~ levels[2], 
      Intresse == 3 ~ levels[3],
      Intresse == 4 ~ levels[4],
      Intresse == 5 ~ levels[5],
      Intresse == 6 ~ levels[6],
      TRUE ~  levels[7]) %>% factor(levels),
    Angebot = case_when(
      Angebot == 1 ~ levels[1], 
      Angebot == 2 ~ levels[2], 
      Angebot == 3 ~ levels[3],
      Angebot == 4 ~ levels[4],
      Angebot == 5 ~ levels[5],
      Angebot == 6 ~ levels[6],
      TRUE ~  levels[7]) %>% factor(levels),
    Inhalt = case_when(
      Inhalt == 1 ~ levels[1], 
      Inhalt == 2 ~ levels[2], 
      Inhalt == 3 ~ levels[3],
      Inhalt == 4 ~ levels[4],
      Inhalt == 5 ~ levels[5],
      Inhalt == 6 ~ levels[6],
      TRUE ~  levels[7]) %>% factor(levels),
    Trends = case_when(
      Trends == 1 ~ levels[1], 
      Trends == 2 ~ levels[2], 
      Trends == 3 ~ levels[3],
      Trends == 4 ~ levels[4],
      Trends == 5 ~ levels[5],
      Trends == 6 ~ levels[6],
      TRUE ~  levels[7]) %>% factor(levels),
    Unternehmen = case_when(
      Unternehmen == 1 ~ levels[1], 
      Unternehmen == 2 ~ levels[2], 
      Unternehmen == 3 ~ levels[3],
      Unternehmen == 4 ~ levels[4],
      Unternehmen == 5 ~ levels[5],
      Unternehmen == 6 ~ levels[6],
      TRUE ~  levels[7]) %>% factor(levels),
    Aktionen = case_when(
      Aktionen == 1 ~ levels[1], 
      Aktionen == 2 ~ levels[2], 
      Aktionen == 3 ~ levels[3],
      Aktionen == 4 ~ levels[4],
      Aktionen == 5 ~ levels[5],
      Aktionen == 6 ~ levels[6],
      TRUE ~  levels[7]) %>% factor(levels))


q15_EmailNewsletterprivatAngepasst <- q15_EmailNewsletterprivat %>% gather(Intresse, Aktionen, Angebot, Inhalt, Trends, Unternehmen, key = Grund, value = Frequenz)

q15_EmailNewsletterprivatAngepasst <- q15_EmailNewsletterprivatAngepasst %>% filter(!is.na(Frequenz))

q15_EmailNewsletterprivatAngepasst <- q15_EmailNewsletterprivatAngepasst %>% mutate(Frequenz = "privat")

q15_EmailNewsletterfirmAngepasst <- q15_EmailNewsletterfirm %>% gather(Intresse, Aktionen, Angebot, Inhalt, Trends, Unternehmen, key = Grund, value = Frequenz)

q15_EmailNewsletterfirmAngepasst <- q15_EmailNewsletterfirmAngepasst %>% filter(!is.na(Frequenz))
q15_EmailNewsletterfirmAngepasst <- q15_EmailNewsletterfirmAngepasst %>% mutate(Frequenz = "geschäftlich")

q15_EmailNewsletterprivatAngepasst$Grund <- as.factor(q15_EmailNewsletterprivatAngepasst$Grund)
q15_EmailNewsletterfirmAngepasst$Grund <- as.factor(q15_EmailNewsletterfirmAngepasst$Grund)
q15_EmailNewsletterprivatAngepasst$Grund <- factor(q15_EmailNewsletterprivatAngepasst$Grund, levels = columnNames1)
q15_EmailNewsletterfirmAngepasst$Grund <- factor(q15_EmailNewsletterfirmAngepasst$Grund, levels = columnNames1)

q15_EmailNewsletter <- rbind(q15_EmailNewsletterprivatAngepasst,q15_EmailNewsletterfirmAngepasst)
q15_EmailNewsletter$Frequenz <- as.factor(q15_EmailNewsletter$Frequenz)

q15_EmailNewsletterJoined <- JoinTableAlterAndGeschlecht(q15_EmailNewsletter)

q15_EmailNewsletter %>% ggplot(aes(x=Frequenz, fill= Grund)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + coord_flip()

q_frequenz <- getfrequenz(subset(q15_EmailNewsletterprivat, select = columnNames1),1,levels(q15_EmailNewsletterprivatAngepasst$Grund), c("Email-Newsletter"), c(1:6), TRUE)

knitr::kable(
  q_frequenz, longtable = TRUE, booktabs = TRUE,
  caption = "privat"
)

q_frequenz <- getfrequenz(subset(q15_EmailNewsletterfirm, select = columnNames1),1,levels(q15_EmailNewsletterfirmAngepasst$Grund), c("Email-Newsletter"), c(1:6), TRUE)

knitr::kable(
  q_frequenz, longtable = TRUE, booktabs = TRUE,
  caption = "geschäftlich"
)


frequenzfactors <- factor(columnNames1, levels = columnNames1)

q15_EmailNewsletterJoined %>% ggplot(aes(x=Frequenz, fill= Grund)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q15_EmailNewsletterAlter <- JoinTableAlter(q15_EmailNewsletterprivat)

q_frequenzalter<- getfrequenzAlter15(q15_EmailNewsletterAlter, frequenzfactors, columnNames1)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE, caption = "private"
)

q15_EmailNewsletterAlter2 <- JoinTableAlter(q15_EmailNewsletterfirm)

q_frequenzalter<- getfrequenzAlter15(q15_EmailNewsletterAlter2, frequenzfactors, columnNames1)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE, caption = "geschäftlich"
)


q15_EmailNewsletterJoined %>% ggplot(aes(x=Frequenz, fill= Grund)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q15_EmailNewsletterGeschlecht <- JoinTableGeschlecht(q15_EmailNewsletterprivat)

q_frequenzgeschlecht <- getfrequenzgeschlecht15(q15_EmailNewsletterGeschlecht,frequenzfactors,levels2)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE, caption = "private"
)

q15_EmailNewsletterGeschlecht2 <- JoinTableGeschlecht(q15_EmailNewsletterfirm)

q_frequenzgeschlecht <- getfrequenzgeschlecht15(q15_EmailNewsletterGeschlecht2,frequenzfactors,levels2)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE , caption = "geschäftlich"
)

```


# Einkauf aufgrund eines nicht abonnierten Email-Newsletter

## 16 - Haben Sie schon jemals ein Produkt oder eine Dienstleistung eingekauft, welche von einem nicht abonnierten Email-Newsletter kam?

```{r EmailEinkaufKeinAbo, echo=FALSE}

q16_NichtAbonniert <- subset(dat, select=c("Nummer", "X16_1", "X16_2"))
q16_NichtAbonniert <- q16_NichtAbonniert %>% rename(privat = X16_1, geschäftlich = X16_2)

levels2Angabe = c("Ja(1)", "Nein(2)")
levels2 = c("Ja", "Nein")
levels = addNA(levels2)
columnNames1 <- c("privat", "geschäftlich")
q16_NichtAbonniertAngepasst <- q16_NichtAbonniert %>% subset(select = c(Nummer, privat, geschäftlich)) %>% 
  mutate(
    privat = case_when(
      privat == 1 ~ levels[1], 
      privat == 2 ~ levels[2], 
      TRUE ~  levels[3]) %>% factor(levels),
    geschäftlich = case_when(
      geschäftlich == 1 ~ levels[1], 
      geschäftlich == 2 ~ levels[2], 
      TRUE ~  levels[3]) %>% factor(levels))

q16_NichtAbonniertAngepasst <- q16_NichtAbonniertAngepasst %>% gather(privat, geschäftlich, key = Art, value = Frequenz)

q16_NichtAbonniertAngepasst <- q16_NichtAbonniertAngepasst %>% filter(!is.na(Frequenz))

q16_NichtAbonniertAngepasst$Art <- as.factor(q16_NichtAbonniertAngepasst$Art)
q16_NichtAbonniertAngepasst$Frequenz <- as.factor(q16_NichtAbonniertAngepasst$Frequenz)
q16_NichtAbonniertAngepasst$Art <- factor(q16_NichtAbonniertAngepasst$Art, levels = columnNames1)
q16_NichtAbonniertAngepasst$Frequenz <- factor(q16_NichtAbonniertAngepasst$Frequenz, levels = levels2)

q16_NichtAbonniertJoined <- JoinTableAlterAndGeschlecht(q16_NichtAbonniertAngepasst)

q16_NichtAbonniertAngepasst %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + coord_flip()

q_lageparameter <- getLageparameter(subset(q16_NichtAbonniert, select = columnNames1), levels(q16_NichtAbonniertAngepasst$Art), c(1:2))

knitr::kable(
  q_lageparameter, longtable = TRUE, booktabs = TRUE
)

q_frequenz <- getfrequenz(subset(q16_NichtAbonniert, select = columnNames1),2,levels(q16_NichtAbonniertAngepasst$Art), levels2Angabe, c(1:2), TRUE)

knitr::kable(
  q_frequenz, longtable = TRUE, booktabs = TRUE
)






frequenzfactors <- factor(columnNames1, levels = columnNames1)

q16_NichtAbonniertJoined %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q16_NichtAbonniertAlter <- JoinTableAlter(q16_NichtAbonniert)

q_lageparameterAlter <- getLageparameterAlter(q16_NichtAbonniertAlter, frequenzfactors)

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)

q_frequenzalter<- getfrequenzAlter(q16_NichtAbonniertAlter, frequenzfactors, levels2Angabe, TRUE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)


q16_NichtAbonniertJoined %>% ggplot(aes(x=Frequenz, fill= Art)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q16_NichtAbonniertGeschlecht <- JoinTableGeschlecht(q16_NichtAbonniert)

q_lageparameterGeschlecht <- getLageparameterGeschlecht (q16_NichtAbonniertGeschlecht, frequenzfactors)

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)


q_frequenzgeschlecht <- getfrequenzgeschlecht(q16_NichtAbonniertGeschlecht,frequenzfactors,levels2Angabe, TRUE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)

```

# Bevorzugte Kommunikationsart

## 17 - Welche Kommunikationsarten bevorzugen Sie zwischen Ihnen und einem Unternehmen? (maximal 4)
```{r BevorzugteKommunikation, echo=FALSE}

q17_BevorzugteKommunikation <- subset(dat, select=c("Nummer", "X17_1", "X17_2", "X17_3", "X17_4","X17_5", "X17_6","X17_7", "X17_8","X17_9", "X17_10","X17_10_TEXT"))
q17_BevorzugteKommunikation <- q17_BevorzugteKommunikation  %>% rename(Email = X17_1, Brief = X17_2,
                                                       MobileApp = X17_3, SocialMedia = X17_4,
                                                       Messanger = X17_5, SMS = X17_6,
                                                       Telefon = X17_7, Chatbots = X17_8,
                                                       ServiceProtale = X17_9, Andere = X17_10,
                                                       AndereText = X17_10_TEXT)

    
q17_BevorzugteKommunikationAngepasst <- q17_BevorzugteKommunikation %>% gather(Email, Brief, MobileApp, SocialMedia, Messanger,SMS, Telefon, Chatbots, ServiceProtale, Andere, key = Medium, value = Frequenz)

levels = c("Email", "Brief", "MobileApp", "SocialMedia", "Messanger", "SMS", "Telefon", "Chatbots", "ServiceProtale", "Andere")

q17_BevorzugteKommunikationAngepasst$Medium <- as.factor(q17_BevorzugteKommunikationAngepasst$Medium )
q17_BevorzugteKommunikationAngepasst$Medium  <- factor(q17_BevorzugteKommunikationAngepasst$Medium, levels = levels)

q17_BevorzugteKommunikationAngepasst <- q17_BevorzugteKommunikationAngepasst %>% filter(!is.na(Frequenz))
q17_BevorzugteKommunikationAngepasst$Frequenz <- as.factor(q17_BevorzugteKommunikationAngepasst$Frequenz )


q17_BevorzugteKommunikationAngepasst %>% ggplot(aes(x=Medium)) + geom_bar(fill=colorSingleBar) + xlab("Medium") + ylab("Anzahl") + coord_flip()

q17_BevorzugteKommunikationText <-  q17_BevorzugteKommunikation %>% subset(select = c(AndereText))
q17_BevorzugteKommunikationText$AndereText <- str_trim(q17_BevorzugteKommunikationText$AndereText)

q17_BevorzugteKommunikationText <-  q17_BevorzugteKommunikationText %>% filter(q17_BevorzugteKommunikationText$AndereText != "")
AndereTexte <- data.frame(Andere = q17_BevorzugteKommunikationText)

knitr::kable(
  AndereTexte, longtable = TRUE, booktabs = TRUE
)

q_frequenz <- getfrequenz(subset(q17_BevorzugteKommunikation, select = levels),1,levels(q17_BevorzugteKommunikationAngepasst$Medium), c("Antwortanzahl"), c(1:10), FALSE)

knitr::kable(
  q_frequenz, longtable = TRUE, booktabs = TRUE,
  caption = "privat"
)


q17_BevorzugteKommunikationJoined <- JoinTableAlterAndGeschlecht(q17_BevorzugteKommunikationAngepasst)


frequenzfactors <- factor(levels, levels = levels)

q17_BevorzugteKommunikationJoined %>% ggplot(aes(x=Medium)) + geom_bar(fill=colorSingleBar) + xlab("Medium") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q17_BevorzugteKommunikationAlter <- JoinTableAlter(q17_BevorzugteKommunikation)

q_frequenzalter<- getfrequenzAlter(q17_BevorzugteKommunikationAlter, frequenzfactors,  c("Antwortanzahl"), FALSE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)


q17_BevorzugteKommunikationJoined %>% ggplot(aes(x=Medium)) + geom_bar(fill=colorSingleBar) + xlab("Medium") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q17_BevorzugteKommunikationGeschlecht <- JoinTableGeschlecht(q17_BevorzugteKommunikation)


q_frequenzgeschlecht <- getfrequenzgeschlecht(q17_BevorzugteKommunikationGeschlecht,frequenzfactors, c("Antwortanzahl"), FALSE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)



```


# Verwendete Quellen, um Angebote zu suchen

## 18 - Wie häufig verwenden Sie die folgenden Quellen, um neue Produkte oder Dienstleistungen zu suchen?

```{r QuellenVerwendeHaeufigAngebot, echo=FALSE}

q18_QuellenSuche <- subset(dat, select=c("Nummer", "X18_1", "X18_2", "X18_3", "X18_4","X18_5", "X18_6","X18_7", "X18_8","X18_9", "X18_10", "X18_11","X18b"))
q18_QuellenSuche <- q18_QuellenSuche  %>% rename(Suchmaschine = X18_1, Vergleichsdienst = X18_2,
                                                 Blogs = X18_3, InfluencerIn = X18_4,
                                                 Facebook = X18_5, Instagram = X18_6,
                                                 YouTube = X18_7, Twitter = X18_8,
                                                 Linkedin = X18_9, TikTok = X18_10,
                                                 Andere = X18_11, AndereText = X18b )

columnNames1 <- c("Suchmaschine", "Vergleichsdienst", "Blogs", "InfluencerIn", "Facebook", "Instagram", "YouTube", "Twitter", "Linkedin", "TikTok", "Andere")
columnNamesNumber1 <- c("Nummer","Suchmaschine", "Vergleichsdienst", "Blogs", "InfluencerIn", "Facebook", "Instagram", "YouTube", "Twitter", "Linkedin", "TikTok", "Andere")

levels2Angabe = c("nie(1)", "selten(2)", "gelegentlich(3)","oft(4)","immer(5)")
levels2 = c("nie", "selten", "gelegentlich","oft","immer")
levels = addNA(levels2)
q18_QuellenSucheAngepasst <- q18_QuellenSuche %>% subset(select = columnNamesNumber1) %>% 
  mutate(
            Linkedin = case_when(
      Linkedin == 1 ~ levels[1], 
      Linkedin == 2 ~ levels[2], 
      Linkedin == 3 ~ levels[3],
      Linkedin == 4 ~ levels[4],
      Linkedin == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    TikTok = case_when(
      TikTok == 1 ~ levels[1], 
      TikTok == 2 ~ levels[2], 
      TikTok == 3 ~ levels[3],
      TikTok == 4 ~ levels[4],
      TikTok == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Andere = case_when(
      Andere == 1 ~ levels[1], 
      Andere == 2 ~ levels[2], 
      Andere == 3 ~ levels[3],
      Andere == 4 ~ levels[4],
      Andere == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
        YouTube = case_when(
      YouTube == 1 ~ levels[1], 
      YouTube == 2 ~ levels[2], 
      YouTube == 3 ~ levels[3],
      YouTube == 4 ~ levels[4],
      YouTube == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Twitter = case_when(
      Twitter == 1 ~ levels[1], 
      Twitter == 2 ~ levels[2], 
      Twitter == 3 ~ levels[3],
      Twitter == 4 ~ levels[4],
      Twitter == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Suchmaschine = case_when(
      Suchmaschine == 1 ~ levels[1], 
      Suchmaschine == 2 ~ levels[2], 
      Suchmaschine == 3 ~ levels[3],
      Suchmaschine == 4 ~ levels[4],
      Suchmaschine == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Vergleichsdienst = case_when(
      Vergleichsdienst == 1 ~ levels[1], 
      Vergleichsdienst == 2 ~ levels[2], 
      Vergleichsdienst == 3 ~ levels[3],
      Vergleichsdienst == 4 ~ levels[4],
      Vergleichsdienst == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Blogs = case_when(
      Blogs == 1 ~ levels[1], 
      Blogs == 2 ~ levels[2], 
      Blogs == 3 ~ levels[3],
      Blogs == 4 ~ levels[4],
      Blogs == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    InfluencerIn = case_when(
      InfluencerIn == 1 ~ levels[1], 
      InfluencerIn == 2 ~ levels[2], 
      InfluencerIn == 3 ~ levels[3],
      InfluencerIn == 4 ~ levels[4],
      InfluencerIn == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Facebook = case_when(
      Facebook == 1 ~ levels[1], 
      Facebook == 2 ~ levels[2], 
      Facebook == 3 ~ levels[3],
      Facebook == 4 ~ levels[4],
      Facebook == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels),
    Instagram = case_when(
      Instagram == 1 ~ levels[1], 
      Instagram == 2 ~ levels[2], 
      Instagram == 3 ~ levels[3],
      Instagram == 4 ~ levels[4],
      Instagram == 5 ~ levels[5],
      TRUE ~  levels[6]) %>% factor(levels))

q18_QuellenSucheAngepasst <- q18_QuellenSucheAngepasst %>% gather(Suchmaschine, Vergleichsdienst, Blogs, InfluencerIn, Facebook, Instagram, YouTube, Twitter, Linkedin, TikTok, Andere, key = Quelle, value = Frequenz)

q18_QuellenSucheAngepasst <- q18_QuellenSucheAngepasst %>% filter(!is.na(Frequenz))

q18_QuellenSucheAngepasst$Quelle <- as.factor(q18_QuellenSucheAngepasst$Quelle)
q18_QuellenSucheAngepasst$Frequenz <- as.factor(q18_QuellenSucheAngepasst$Frequenz)
q18_QuellenSucheAngepasst$Quelle <- factor(q18_QuellenSucheAngepasst$Quelle, levels = columnNames1)
q18_QuellenSucheAngepasst$Frequenz <- factor(q18_QuellenSucheAngepasst$Frequenz, levels = levels2)


q18_QuellenSucheJoined <- JoinTableAlterAndGeschlecht(q18_QuellenSucheAngepasst)

q18_QuellenSucheAngepasst %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("Quelle") + ylab("Anzahl") + coord_flip()


q18_QuellenSucheText <-  q18_QuellenSuche %>% subset(select = c(AndereText))
q18_QuellenSucheText$AndereText <- str_trim(q18_QuellenSucheText$AndereText)

q18_QuellenSucheText <-  q18_QuellenSucheText %>% filter(q18_QuellenSucheText$AndereText != "")
AndereTexte <- data.frame(Andere = q18_QuellenSucheText)

knitr::kable(
  AndereTexte, longtable = TRUE, booktabs = TRUE
)


q_lageparameter <- getLageparameter(subset(q18_QuellenSuche, select = columnNames1), levels(q18_QuellenSucheAngepasst$Quelle), c(1:11))

knitr::kable(
  q_lageparameter, longtable = TRUE, booktabs = TRUE
)

q_frequenz <- getfrequenz(subset(q18_QuellenSuche, select = columnNames1
),5,levels(q18_QuellenSucheAngepasst$Quelle), levels2Angabe, c(1:11), TRUE)

knitr::kable(
  q_frequenz, longtable = TRUE, booktabs = TRUE
)






frequenzfactors <- factor(columnNames1, levels = columnNames1)

q18_QuellenSucheJoined %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("Quelle") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q18_QuellenSucheAlter <- JoinTableAlter(q18_QuellenSuche)

q_lageparameterAlter <- getLageparameterAlter(q18_QuellenSucheAlter %>% subset(select = -c(AndereText)), frequenzfactors)

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)

q_frequenzalter<- getfrequenzAlter(q18_QuellenSucheAlter, frequenzfactors, levels2Angabe, TRUE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)


q18_QuellenSucheJoined %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("Quelle") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q18_QuellenSucheGeschlecht <- JoinTableGeschlecht(q18_QuellenSuche)

q_lageparameterGeschlecht <- getLageparameterGeschlecht (q18_QuellenSucheGeschlecht %>% subset(select = -c(AndereText)), frequenzfactors)

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)

q_frequenzgeschlecht <- getfrequenzgeschlecht(q18_QuellenSucheGeschlecht,frequenzfactors,levels2Angabe, TRUE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)


```

# Einkauf aufgrund von Quellen

## 19 - Haben Sie bereits Produkte oder Dienstleistungen eingekauft aufgrund folgender Quellen?

```{r QuellenVerwendeKauf, echo=FALSE}

q19_QuellenKauf <- subset(dat, select=c("Nummer", "X19_1", "X19_2", "X19_3", "X19_4","X19_5", "X19_6","X19_7", "X19_8","X19_9", "X19_10"))
q19_QuellenKauf <- q19_QuellenKauf  %>% rename(Suchmaschine = X19_1, Vergleichsdienst = X19_2,
                                                 Blogs = X19_3, InfluencerIn = X19_4,
                                                 Facebook = X19_5, Instagram = X19_6,
                                                 YouTube = X19_7, Twitter = X19_8,
                                                 Linkedin = X19_9, TikTok = X19_10)

columnNames1 <- c("Suchmaschine", "Vergleichsdienst", "Blogs", "InfluencerIn", "Facebook", "Instagram", "YouTube", "Twitter", "Linkedin", "TikTok")
columnNamesNumber1 <- c("Nummer","Suchmaschine", "Vergleichsdienst", "Blogs", "InfluencerIn", "Facebook", "Instagram", "YouTube", "Twitter", "Linkedin", "TikTok")


levels2Angabe = c("Ja(1)", "Nein(2)")
levels2 = c("Ja", "Nein")
levels = addNA(levels2)
q19_QuellenKaufAngepasst <- q19_QuellenKauf %>% subset(select = columnNamesNumber1) %>% 
  mutate(
            Linkedin = case_when(
      Linkedin == 1 ~ levels[1], 
      Linkedin == 2 ~ levels[2], 
      TRUE ~  levels[3]) %>% factor(levels),
    TikTok = case_when(
      TikTok == 1 ~ levels[1], 
      TikTok == 2 ~ levels[2], 
      TRUE ~  levels[3]) %>% factor(levels),
        YouTube = case_when(
      YouTube == 1 ~ levels[1], 
      YouTube == 2 ~ levels[2], 
      TRUE ~  levels[3]) %>% factor(levels),
    Twitter = case_when(
      Twitter == 1 ~ levels[1], 
      Twitter == 2 ~ levels[2], 
      TRUE ~  levels[3]) %>% factor(levels),
    Suchmaschine = case_when(
      Suchmaschine == 1 ~ levels[1], 
      Suchmaschine == 2 ~ levels[2], 
      TRUE ~  levels[3]) %>% factor(levels),
    Vergleichsdienst = case_when(
      Vergleichsdienst == 1 ~ levels[1], 
      Vergleichsdienst == 2 ~ levels[2], 
      TRUE ~  levels[3]) %>% factor(levels),
    Blogs = case_when(
      Blogs == 1 ~ levels[1], 
      Blogs == 2 ~ levels[2], 
      TRUE ~  levels[2]) %>% factor(levels),
    InfluencerIn = case_when(
      InfluencerIn == 1 ~ levels[1], 
      InfluencerIn == 2 ~ levels[2], 
      TRUE ~  levels[3]) %>% factor(levels),
    Facebook = case_when(
      Facebook == 1 ~ levels[1], 
      Facebook == 2 ~ levels[2], 
      TRUE ~  levels[3]) %>% factor(levels),
    Instagram = case_when(
      Instagram == 1 ~ levels[1], 
      Instagram == 2 ~ levels[2], 
      TRUE ~  levels[3]) %>% factor(levels))

q19_QuellenKaufAngepasst <- q19_QuellenKaufAngepasst %>% gather(Suchmaschine, Vergleichsdienst, Blogs, InfluencerIn, Facebook, Instagram, YouTube, Twitter, Linkedin, TikTok, key = Quelle, value = Frequenz)

q19_QuellenKaufAngepasst <- q19_QuellenKaufAngepasst %>% filter(!is.na(Frequenz))

q19_QuellenKaufAngepasst$Quelle <- as.factor(q19_QuellenKaufAngepasst$Quelle)
q19_QuellenKaufAngepasst$Frequenz <- as.factor(q19_QuellenKaufAngepasst$Frequenz)
q19_QuellenKaufAngepasst$Quelle <- factor(q19_QuellenKaufAngepasst$Quelle, levels = columnNames1)
q19_QuellenKaufAngepasst$Frequenz <- factor(q19_QuellenKaufAngepasst$Frequenz, levels = levels2)

q19_QuellenKaufJoined <- JoinTableAlterAndGeschlecht(q19_QuellenKaufAngepasst)

q19_QuellenKaufAngepasst %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + coord_flip()

q_lageparameter <- getLageparameter(subset(q19_QuellenKauf, select = columnNames1), levels(q19_QuellenKaufAngepasst$Quelle), c(1:10))

knitr::kable(
  q_lageparameter, longtable = TRUE, booktabs = TRUE
)

q_frequenz <- getfrequenz(subset(q19_QuellenKauf, select = columnNames1
),2,levels(q19_QuellenKaufAngepasst$Quelle), levels2Angabe, c(1:10), TRUE)

knitr::kable(
  q_frequenz, longtable = TRUE, booktabs = TRUE
)


frequenzfactors <- factor(columnNames1, levels = columnNames1)

q19_QuellenKaufJoined %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q19_QuellenKaufAlter <- JoinTableAlter(q19_QuellenKauf)

q_lageparameterAlter <- getLageparameterAlter(q19_QuellenKaufAlter, frequenzfactors)

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)


q_frequenzalter<- getfrequenzAlter(q19_QuellenKaufAlter, frequenzfactors, levels2Angabe, TRUE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)


q19_QuellenKaufJoined %>% ggplot(aes(x=Frequenz, fill= Quelle)) + geom_bar(position = "dodge2") + xlab("") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q19_QuellenKaufGeschlecht <- JoinTableGeschlecht(q19_QuellenKauf)

q_lageparameterGeschlecht <- getLageparameterGeschlecht (q19_QuellenKaufGeschlecht, frequenzfactors)

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE
)


q_frequenzgeschlecht <- getfrequenzgeschlecht(q19_QuellenKaufGeschlecht,frequenzfactors,levels2Angabe, TRUE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)


```


# Medien

## 20 - Welches Medium verwenden Sie aktuell, wenn Sie sich über neue Produkte oder Dienstleistungen informieren?

```{r Medien1, echo=FALSE}

q20_MediumAktuell <- subset(dat, select=c("Nummer", "X20", "X20_5_TEXT"))
q20_MediumAktuell <- q20_MediumAktuell %>% rename(Medium = X20, AndereText = X20_5_TEXT)

q20_MediumAktuell <- q20_MediumAktuell %>% filter(!is.na(Medium))
levels2 = c("Text(Artikel, Newsletter)", "Bilder / Grafiken / Fotos", "Audio (Podcasts usw.)","Video","Andere")
levels = addNA(levels2)

q20_MediumAktuellAngepasst <- q20_MediumAktuell  %>% subset(select =c(Nummer, Medium)) %>% 
  mutate(
  Medium = case_when(
    Medium == 1 ~ levels[1], 
    Medium == 2 ~ levels[2], 
    Medium == 3 ~ levels[3],
    Medium == 4 ~ levels[4],
    Medium == 5 ~ levels[5],
    TRUE ~  levels[6]) %>% factor(levels))

q20_MediumAktuellAngepasst <- q20_MediumAktuellAngepasst %>% filter(!is.na(Medium))

q20_MediumAktuellAngepasst %>% ggplot(aes(x=Medium)) + geom_bar(fill=colorSingleBar) + xlab("") + ylab("Anzahl") + coord_flip()

q20_MediumAktuellText <- q20_MediumAktuell %>% subset(select = c(AndereText))
q20_MediumAktuellText$AndereText <- str_trim(q20_MediumAktuellText$AndereText)
q20_MediumAktuellText$AndereText <- str_replace(q20_MediumAktuellText$AndereText, "\u0081","ue")

q20_MediumAktuellText <-  q20_MediumAktuellText %>% filter(q20_MediumAktuellText$AndereText != "")
AndereTexte <- data.frame(Andere = q20_MediumAktuellText)

knitr::kable(
  AndereTexte, longtable = TRUE, booktabs = TRUE
)

q_lageparameter <- getLageparameter1Dimensional(subset(q20_MediumAktuell, select = c(Medium)), "Medium")

knitr::kable(
  q_lageparameter, longtable = TRUE, booktabs = TRUE
)

q_frequenz <- getfrequenz1Dimension(subset(q20_MediumAktuell, select = c(Medium)),5, levels(q20_MediumAktuellAngepasst$Medium), c(1:5))

knitr::kable(
  q_frequenz, longtable = TRUE, booktabs = TRUE
)

q20_MediumAktuellJoined <- JoinTableAlterAndGeschlecht(q20_MediumAktuellAngepasst)

q20_MediumAktuellJoined %>% ggplot(aes(x=Medium)) + geom_bar(fill=colorSingleBar) + xlab("Prozent") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q20_MediumAktuellJoinedAlter <- JoinTableAlter(q20_MediumAktuell %>% subset(select = -c(AndereText)))

q_lageparameterAlter <- getLageparameter1DimensionalAlter(q20_MediumAktuellJoinedAlter, "Medium")

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)

q_frequenzAlter <- getfrequenz1DimensionAlter(q20_MediumAktuellJoinedAlter,factor(levels2))


knitr::kable(
  q_frequenzAlter, longtable = TRUE, booktabs = TRUE
)

q20_MediumAktuellJoined %>% ggplot(aes(x=Medium)) + geom_bar(fill=colorSingleBar) + xlab("Prozent") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q20_MediumAktuellJoinedGeschlecht <- JoinTableGeschlecht(q20_MediumAktuell%>% subset(select = -c(AndereText)))

q_lageparameterGeschlecht <- getLageparameter1DimensionalGeschlecht (q20_MediumAktuellJoinedGeschlecht, "Medium")

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE

)

q_frequenzGeschlecht <- getfrequenz1DimensionGeschlecht(q20_MediumAktuellJoinedGeschlecht,factor(levels2))

knitr::kable(
  q_frequenzGeschlecht, longtable = TRUE, booktabs = TRUE
)

```

## 21 - Welches Medium würden Sie sich in Zukunft vermehrt wünschen für Werbebotschaften?

```{r Medien2, echo=FALSE}

q21_MediumZukunft <- subset(dat, select=c("Nummer", "X21", "X21_5_TEXT"))
q21_MediumZukunft <- q21_MediumZukunft %>% rename(Medium = X21, AndereText = X21_5_TEXT)

q21_MediumZukunft1 <- q21_MediumZukunft %>% filter(!is.na(Medium))

levels2 = c("Text(Artikel, Newsletter)", "Bilder / Grafiken / Fotos", "Audio (Podcasts usw.)","Video","Andere")
levels = addNA(levels2)
q21_MediumZukunftAngepasst <- q21_MediumZukunft1  %>% subset(select =c(Nummer, Medium)) %>% 
  mutate(
  Medium = case_when(
    Medium == 1 ~ levels[1], 
    Medium == 2 ~ levels[2], 
    Medium == 3 ~ levels[3],
    Medium == 4 ~ levels[4],
    Medium == 5 ~ levels[5],
    TRUE ~  levels[6]) %>% factor(levels))

q21_MediumZukunftAngepasst <- q21_MediumZukunftAngepasst %>% filter(!is.na(Medium))

q21_MediumZukunftAngepasst %>% ggplot(aes(x=Medium)) + geom_bar(fill=colorSingleBar) + xlab("") + ylab("Anzahl") + coord_flip()

q21_MediumZukunftText <-  q21_MediumZukunft %>% subset(select = c(AndereText))
q21_MediumZukunftText$AndereText <- str_trim(q21_MediumZukunftText$AndereText)
q21_MediumZukunftText$AndereText <- str_replace(q21_MediumZukunftText$AndereText, "\u0081","ue")

q21_MediumZukunftText <-  q21_MediumZukunftText %>% filter(q21_MediumZukunftText$AndereText != "")
AndereTexte <- data.frame(Andere = q21_MediumZukunftText)

knitr::kable(
  AndereTexte, longtable = TRUE, booktabs = TRUE
)


q2_lageparameter <- getLageparameter1Dimensional(subset(q21_MediumZukunft1, select = c(Medium)), "Medium")

knitr::kable(
  q2_lageparameter, longtable = TRUE, booktabs = TRUE
)

q2_frequenz <- getfrequenz1Dimension(subset(q21_MediumZukunft1, select = c(Medium)),5, levels(q21_MediumZukunftAngepasst$Medium), c(1:5))

knitr::kable(
  q2_frequenz, longtable = TRUE, booktabs = TRUE
)

q21_MediumZukunftJoined <- JoinTableAlterAndGeschlecht(q21_MediumZukunftAngepasst)


q21_MediumZukunftJoined %>% ggplot(aes(x=Medium)) + geom_bar(fill=colorSingleBar) + xlab("Prozent") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q21_MediumZukunftJoinedAlter <- JoinTableAlter(q21_MediumZukunft1 %>% subset(select = c(Nummer, Medium)))

q_lageparameterAlter <- getLageparameter1DimensionalAlter(q21_MediumZukunftJoinedAlter, "Medium")

knitr::kable(
  q_lageparameterAlter, longtable = TRUE, booktabs = TRUE
)


q_frequenzAlter <- getfrequenz1DimensionAlter(q21_MediumZukunftJoinedAlter,factor(levels2))


knitr::kable(
  q_frequenzAlter, longtable = TRUE, booktabs = TRUE
)

q21_MediumZukunftJoined %>% ggplot(aes(x=Medium)) + geom_bar(fill=colorSingleBar) + xlab("Prozent") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q21_MediumZukunftJoinedGeschlecht <- JoinTableGeschlecht(q21_MediumZukunft1 %>% subset(select = c(Nummer, Medium)))

q_lageparameterGeschlecht <- getLageparameter1DimensionalGeschlecht (q21_MediumZukunftJoinedGeschlecht, "Medium")

knitr::kable(
  q_lageparameterGeschlecht, longtable = TRUE, booktabs = TRUE

)

q_frequenzGeschlecht <- getfrequenz1DimensionGeschlecht(q21_MediumZukunftJoinedGeschlecht,factor(levels2))

knitr::kable(
  q_frequenzGeschlecht, longtable = TRUE, booktabs = TRUE
)

```


## 22 - Welches Medium vermittelt die Vorteile eines Produkts oder einer Dienstleistung aus Ihrer Sicht am besten?
```{r MediumBest, echo=FALSE}

q22_MediumVorteil <- subset(dat, select=c("Nummer", "X22_1", "X22_2", "X22_3", "X22_4", "X22_5", "X22_5_TEXT"))
q22_MediumVorteil <- q22_MediumVorteil %>% rename(Text = X22_1, Bilder = X22_2,
                                                  Audio = X22_3, Video =X22_4,
                                                  Andere = X22_5, AndereText = X22_5_TEXT)

    
q22_MediumVorteilAngepasst <- q22_MediumVorteil %>% gather(Text, Bilder, Audio, Video, Andere, key = Medium, value = Frequenz)

q22_MediumVorteilAngepasst <- q22_MediumVorteilAngepasst %>% filter(!is.na(Frequenz))

levels = c("Text", "Bilder", "Audio","Video","Andere")

q22_MediumVorteilAngepasst$Medium <- as.factor(q22_MediumVorteilAngepasst$Medium )
q22_MediumVorteilAngepasst$Medium  <- factor(q22_MediumVorteilAngepasst$Medium, levels = levels)
q22_MediumVorteilAngepasst <- q22_MediumVorteilAngepasst %>% filter(!is.na(Frequenz))
q22_MediumVorteilAngepasst$Frequenz <- as.factor(q22_MediumVorteilAngepasst$Frequenz )


q22_MediumVorteilAngepasst %>% ggplot(aes(x=Medium)) + geom_bar(fill=colorSingleBar) + xlab("Medium") + ylab("Anzahl") + coord_flip()

q22_MediumVorteilText <-  q22_MediumVorteil %>% subset(select = c(AndereText))
q22_MediumVorteilText$AndereText <- str_trim(q22_MediumVorteilText$AndereText)
q22_MediumVorteilText$AndereText <- str_replace(q22_MediumVorteilText$AndereText, "\u0081","ue")

q22_MediumVorteilText <-  q22_MediumVorteilText %>% filter(q22_MediumVorteilText$AndereText != "")
AndereTexte <- data.frame(Andere = q22_MediumVorteilText)

knitr::kable(
  AndereTexte, longtable = TRUE, booktabs = TRUE
)

q_frequenz <- getfrequenz(subset(q22_MediumVorteil, select = levels),1,levels(q22_MediumVorteilAngepasst$Medium), c("Antwortanzahl"), c(1:5), FALSE)

knitr::kable(
  q_frequenz, longtable = TRUE, booktabs = TRUE,
  caption = "privat"
)


q22_MediumVorteilJoined <- JoinTableAlterAndGeschlecht(q22_MediumVorteilAngepasst)

frequenzfactors <- factor(levels, levels = levels)

q22_MediumVorteilJoined %>% ggplot(aes(x=Medium)) + geom_bar(fill=colorSingleBar) + xlab("Medium") + ylab("Anzahl") + facet_wrap(.~AlterText, nrow=3, ncol = 2, scales = "free", dir = "h")  + coord_flip()

q22_MediumVorteilAlter <- JoinTableAlter(q22_MediumVorteil %>% subset(select = -c(AndereText)))

q_frequenzalter<- getfrequenzAlter(q22_MediumVorteilAlter, frequenzfactors, c("Antwortanzahl"), FALSE)

knitr::kable(
  q_frequenzalter, longtable = TRUE, booktabs = TRUE
)


q22_MediumVorteilJoined %>% ggplot(aes(x=Medium)) + geom_bar(fill=colorSingleBar) + xlab("Medium") + ylab("Anzahl") + facet_wrap(.~GeschlechtText)  + coord_flip()

q22_MediumVorteilGeschlecht <- JoinTableGeschlecht(q22_MediumVorteil %>% subset(select = -c(AndereText)))


q_frequenzgeschlecht <- getfrequenzgeschlecht(q22_MediumVorteilGeschlecht,frequenzfactors,c("Antwortanzahl"), FALSE)

knitr::kable(
  q_frequenzgeschlecht, longtable = TRUE, booktabs = TRUE
)


```

# Reliability (Verlässlichkeit)
```{r Relaiability, echo=FALSE, warning= FALSE, message= FALSE}

q1_Suchmaschine <-  subset(dat, select=-c(X01b, X06b, X17_10_TEXT, X18b, X20_5_TEXT, X21_5_TEXT, X22_5_TEXT, X15_1_1, X15_1_2, X15_2_1, X15_2_2, X15_3_1, X15_3_2, X15_4_1, X15_4_2, X15_5_1, X15_5_2, X15_6_1, X15_6_2,X17_1, X17_2, X17_3, X17_4, X17_5, X17_6, X17_7, X17_8, X17_9, X17_10,X22_1, X22_2, X22_3, X22_4, X22_5))

result <- splitHalf(q1_Suchmaschine)

datasetsplithalf <- data.frame()

datasetsplithalf[1,1] <- c("Maximum Guttman's lambda 4")
datasetsplithalf[1,2] <- round(result$maxrb, digits = 2)

datasetsplithalf[2,1] <- c("Guttman's lambda 6")
datasetsplithalf[2,2] <- round(result$lambda6, digits = 2)

datasetsplithalf[3,1] <- c("Durchschnitts split half Reliability")
datasetsplithalf[3,2] <- round(result$meanr, digits = 2)

datasetsplithalf[4,1] <- c("Guttman lambda 3 (alpha)")
datasetsplithalf[4,2] <- round(result$alpha, digits = 2)


datasetsplithalf[5,1] <- c("Guttman lambda 2 ")
datasetsplithalf[5,2] <- round(result$lambda2, digits = 2)

datasetsplithalf[6,1] <- c("Minimum split half reliability (beta) ")
datasetsplithalf[6,2] <- round(result$minrb, digits = 2)



datasetsplithalf <- datasetsplithalf %>% rename(
  Variante = V1,
  Wert = V2)

knitr::kable(
  datasetsplithalf, longtable = TRUE, booktabs = TRUE , caption = "Split Half Alpha"
)

```